<!---this is pands.html file---->123
<script>

    let proId_ = null;
    let dbNoUp_item = null;
    let dbUp_item = null;

    // تهيئة الجدول
    async function initItemsPage () 
    {
        try
        {
            proId_ = "ite_" + localStorage.getItem( "selectedProject" );
            dbNoUp_item = await new noUpgrade( proId_ );

            //ادخال نص التعريف لكل البنود
            const inputs = document.querySelectorAll( '[id="pandText"]' );
            inputs.forEach( input =>
            {
                input.placeholder = getLang( 1260 );
            } );
            await renumber_();
        } catch ( er )
        {
            console.error(er);
        }
    }

    proId_ = "ite_" + localStorage.getItem( "selectedProject" );

    let pandsTable = new setTableParameter(
        "itemsTable", // ID of the container element
        proId_, // Table ID and database name
        "itemsTable_raw", // ID of the row template to copy
        "itemsTable_Altraw", // ID of alternate row to show on click
        true, // Show table header?
        true, // Add alternate div when row is clicked?
        true // Start with new row?
    );

 
    async function renumber_ ()
    {
        isTableWatcherEnabled = false; // تعطيل الكود مؤقتًا
        try
        {
            while ( await pandsTable.checkProcessRun() == true ) { await delay( 50 ); }
            // تأخير قليل قبل بدء العملية
            let numbeList = [];
            let parentId = [];
            let outPuts = document.querySelectorAll( '[id="pandNumber"]' );

            // جمع القيم الحالية
            outPuts.forEach( ( el ) =>
            {
                numbeList.push( el.value );


                parentId.push( el.parentElement.parentElement.parentElement.parentElement.parentElement.id.replace( '_', '' ) );



            } );

            // إعادة الترقيم
            let noAfterRenumber = reNumber( numbeList ); // تأكد أن reNumber تعيد مصفوفة مرقمة حسب ترتيب re
            let index_ = null;

            // تعيين القيم الجديدة
            outPuts.forEach( ( el, index ) =>
            {
                index_ = noAfterRenumber[ index ];
                if(parentId[ index ] ){
                if ( /^[a-zA-Z]{4}\d+/.test( parentId[ index ] ) )
                {
                  
                    // قم بتسجيل القيم لتوضيح التغييرات
                    // تحديث البيانات في قاعدة البيانات
                    dbNoUp_item.keySet( parentId[ index ].replace( '_', '' ), 'pandNumber', index_ );
                    // تعيين القيمة الجديدة للعناصر
                    el.value = index_;
                }
            }
            } );

            await delay( 200 ); // تأخير قليل بعد التعيين
        } catch ( error )
        {
            console.error( "حدث خطأ أثناء إعادة الترقيم:", error );
        } finally
        {
            isTableWatcherEnabled = true; // إعادة تمكين الكود بعد الانتهاء من العملية
        }
    }


</script>

<div id="itemsTable"></div>
<!-- مكان إضافة الجدول -->

<div DivId id="itemsTable_raw" style="display: none" class="">
    <table>
        <thead class="hide-text">
            <tr>
                <th id="t_37"></th>
                <th id="t_413"></th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>
                    <input id="pandNumber" type="text" placeholder=""
                        style="border: none; background-color: transparent; color: black" />
                </td>
                <td>
                    <input id="pandText" type="text" placeholder=""
                        style="border: none; background-color: transparent; color: black" />
                </td>
            </tr>
        </tbody>
    </table>
</div>

<div DivId id="itemsTable_Altraw" style="display: none" class="">
    <div style="min-height: 6px"></div>
    <button type="button" id="t_138_open" class="buttonT"></button>
    <button type="button" id="t_1261_controlNum" class="buttonT"></button>
</div>
<script>

</script>
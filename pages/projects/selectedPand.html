123<style>
    .section_selectedPand {
        display: none;
        padding: 20px;
        background-color: white;
        margin: 10px;
        border-radius: 10px;
    }

    .active_selectedPand {
        display: block;
    }
</style>



<script>

    let dataBaseIdForSelectedPand = null;
    let dbNoUpgradSelectedPand = null;
    let dbUpgradSelectedPand = null;
    let selectedPandId = null;
    async function initSelectedPandPage ()
    {

        dataBaseIdForSelectedPand = 'ite_' + localStorage.getItem( 'selectedProject' );
        dbNoUpgradSelectedPand = await new noUpgrade( dataBaseIdForSelectedPand );
        dbUpgradSelectedPand = await new upgrade( dataBaseIdForSelectedPand );
        selectedPandId = localStorage.getItem( 'selectedPand' );
        //عرض معرف البند
        document.getElementById( "selectedPandId" ).innerText = selectedPandId;
        await restoreAllInputsFromIndexDB( "mainSelectedPandPage", dbNoUpgradSelectedPand, selectedPandId );
        await watchingAllInputs2IndexDB( "mainSelectedPandPage", dbNoUpgradSelectedPand, selectedPandId );

    }

</script>

<div id="mainSelectedPandPage">

    <textarea id="pandText"></textarea>

    <br>
    <table>
        <tr>
            <td>
                <!--   الوحدات -->
                <button onclick="showSection_selectedPand('units')">
                    <img id="i_units" alt="units"
                        style="width:20px; height:20px; vertical-align:middle; margin-left:5px;">
                    <br> <span id="t_48"></span>
                </button>
            </td>
            <td>
                <!-- الاشتراطات -->
                <button onclick="showSection_selectedPand('condations')">
                    <img id="i_condation_mo" alt="condations"
                        style="width:20px; height:20px; vertical-align:middle; margin-left:5px;">
                    <br> <span id="t_279"></span>
                </button>
            </td>
        </tr>
    </table>


    <br>
    <br>
    <!-- ✅ الأقسام (تظهر حسب القسم المختار) -->
    <div id="units" class="section_selectedPand"></div>
    <div id="condations" class="section_selectedPand"></div>

    <!-- الكود التعريفي -->
    <br>
    <h3 id="t_615"></h3>
    <label id="selectedPandId"></label>

</div>

<!-- ✅ JavaScript الخاص بالتهيئة والتحميل -->
<script>
    const loadedPages_selectedPand = {
        units: false,
        condations: false
    };

    const pageMap_selectedPand = {
        units: "pages/projects/units.html",
        condations: "pages/projects/condations.html"
    };

    let selectedPage_selectedPand = null;//تستخدم في دوال اخري خارج هذة الصفحة لذا يجب عدم تغير الاسم
    let targetSection_selectedPand = null;

    //يجب الحفاظ علي اسم الداله كما هو لانها تستخدم من خارج الصفحة
    async function showSection_selectedPand ( sectionId )
    {
        await loadSection_selectedPand( sectionId );
    }

    async function loadSection_selectedPand ( sectionId )
    {
        try
        {
            if ( selectedPage_selectedPand === sectionId && loadedPages_selectedPand[ sectionId ] ) return;

            selectedPage_selectedPand = sectionId;
            targetSection_selectedPand = document.getElementById( sectionId );

            document.querySelectorAll( ".section_selectedPand" ).forEach( section =>
                section.classList.remove( "active_selectedPand" )
            );
            targetSection_selectedPand.classList.add( "active_selectedPand" );

            if ( !loadedPages_selectedPand[ sectionId ] && pageMap_selectedPand[ sectionId ] )
            {
                targetSection_selectedPand.innerHTML = '<div class="loader">جاري التحميل...</div>';
                await loadPageContent_selectedPand( sectionId, targetSection_selectedPand );
                loadedPages_selectedPand[ sectionId ] = true;
            }

            await handleSectionInit_selectedPand( sectionId );
            await setTextAndImage();

        } catch ( error )
        {
            console.error( "خطأ أثناء تحميل القسم:", error );
            targetSection_selectedPand.innerHTML = "<p>⚠️ فشل تحميل الصفحة.</p>";
        }
    }

    async function loadPageContent_selectedPand ( sectionId, container )
    {
        try
        {
            const url = pageMap_selectedPand[ sectionId ];
            const response = await fetch( url );
            if ( !response.ok ) throw new Error( "الملف غير موجود" );

            const html = await response.text();
            const temp = document.createElement( "div" );
            temp.innerHTML = html;

            const scripts = temp.querySelectorAll( "script" );
            scripts.forEach( script => script.remove() );

            container.innerHTML = temp.innerHTML;

            // تحميل السكربتات واحداً تلو الآخر
            for ( const script of scripts )
            {
                await new Promise( ( resolve, reject ) =>
                {
                    const newScript = document.createElement( "script" );
                    if ( script.src )
                    {
                        newScript.src = script.src;
                        newScript.onload = resolve;
                        newScript.onerror = reject;
                    } else
                    {
                        newScript.textContent = script.textContent;
                        resolve();
                    }
                    document.body.appendChild( newScript );
                } );
            }

        } catch ( error )
        {
            console.error( "خطأ أثناء تحميل محتوى الصفحة:", error );
        }
    }

    async function handleSectionInit_selectedPand ( sectionId )
    {
        try
        {

            switch ( sectionId )
            {
                case 'condations':
                    // await initCondationsPage();
                    break;
                case 'units':
                    await initUnitPandPage();
                    break;

            }
        }
        catch ( error )
        {
            console.error( "خطأ أثناء تهيئة القسم:", error );
        }

    }

</script>
<script>
  
function calculateUnifiedPercentAndPriceFromArrays(values, percents, prices) {
  if (values.length !== percents.length || values.length !== prices.length) {
    throw new Error("Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ØµÙÙˆÙØ§Øª ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ø¨Ø·ÙˆÙ„ Ù…ØªØ³Ø§ÙˆÙ.");
  }

  let totalSum = 0;
  let valueSum = 0;
  let weightedPriceSum = 0;

  for (let i = 0; i < values.length; i++) {
    totalSum += values[i] * (percents[i] / 100) * prices[i];
    valueSum += values[i];
    weightedPriceSum += prices[i] * values[i];
  }

  // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù…ÙˆØ­Ø¯ ÙƒÙ…ØªÙˆØ³Ø· Ù…Ø±Ø¬Ø­ Ù„Ù„Ø£Ø³Ø¹Ø§Ø±
  let foundPrice = weightedPriceSum / valueSum;

  // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…ÙˆØ­Ø¯Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø©
  let foundPercent = (totalSum / (foundPrice * valueSum)) * 100;

  // Ø¶Ø¨Ø· Ø§Ù„Ù†Ø³Ø¨Ø© Ø¶Ù…Ù† Ø§Ù„Ù…Ø¬Ø§Ù„ [1, 100]
  if (foundPercent > 100) foundPercent = 100;
  if (foundPercent < 1) foundPercent = 1;

  // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù…ÙˆØ­Ø¯ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…ØµØ­Ø­Ø©
  foundPrice = totalSum / ((foundPercent / 100) * valueSum);

  return {
    totalSum: totalSum.toFixed(2),
    valueSum: valueSum,
    foundPercent: foundPercent.toFixed(2),
    foundPrice: foundPrice.toFixed(3),
    checkTotal: (foundPrice * (foundPercent / 100) * valueSum).toFixed(2)
  };
}

// Ù…Ø«Ø§Ù„ Ø§Ø³ØªØ®Ø¯Ø§Ù…:
const values = [-5, 3, 6];
const percents = [100, 100, 100];
const prices = [30, 40, 50];

const result = calculateUnifiedPercentAndPriceFromArrays(values, percents, prices);

console.log("ğŸ“Š Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ:", result.totalSum);
console.log("ğŸ”¢ Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ù‚ÙŠÙ…:", result.valueSum);
console.log("ğŸ“ˆ Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…ÙˆØ­Ø¯Ø©:", result.foundPercent + "%");
console.log("ğŸ’° Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù…ÙˆØ­Ø¯:", result.foundPrice);
console.log("âœ… Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù†Ø§ØªØ¬:", result.checkTotal);


</script>
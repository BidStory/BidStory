<input type="text" id="baseCurrency" placeholder="Ø§Ù„Ø¹Ù…Ù„Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© (Ù…Ø«Ù„Ø§Ù‹: USD)" value="USD"><br>
<input type="text" id="targetCurrency" placeholder="Ø§Ù„Ø¹Ù…Ù„Ø© Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ© (Ù…Ø«Ù„Ø§Ù‹: EGP)" value="EGP"><br>
<button onclick="getExchangeRate()">âœ… ØªØ­ÙˆÙŠÙ„</button><br><br>

<p id="rateResult">â€”</p>

<script>
    async function getExchangeRate() {
        const baseCurrency = document.getElementById("baseCurrency").value.trim().toUpperCase();
        const targetCurrency = document.getElementById("targetCurrency").value.trim().toUpperCase();
        const resultElement = document.getElementById("rateResult");

        resultElement.textContent = "Ø¬Ø§Ø±ÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...";
        resultElement.style.color = "black";

        try {
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµØ­Ø©
            if(baseCurrency.length !== 3 || targetCurrency.length !== 3) {
                throw new Error("âŒ ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù…ÙˆØ² Ø¹Ù…Ù„Ø§Øª Ù…ÙƒÙˆÙ†Ø© Ù…Ù† 3 Ø£Ø­Ø±Ù");
            }

            if(baseCurrency === targetCurrency) {
                throw new Error("âŒ Ø§Ù„Ø¹Ù…Ù„Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ÙˆØ§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ© Ù…ØªØ·Ø§Ø¨Ù‚ØªØ§Ù†");
            }

            // Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙˆØ§Ø¬Ù‡Ø© Frankfurter Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠØ©
            const url = `https://api.frankfurter.app/latest?from=${baseCurrency}&to=${targetCurrency}`;
            
            const response = await fetch(url);

            if (!response.ok) {
                // Ø¥Ø°Ø§ ÙØ´Ù„ Ø§Ù„Ø·Ù„Ø¨ØŒ Ø¬Ø±Ø¨ Ù…ØµØ¯Ø±Ù‹Ø§ Ø§Ø­ØªÙŠØ§Ø·ÙŠÙ‹Ø§
                return await tryFallbackAPI(baseCurrency, targetCurrency);
            }

            const data = await response.json();

            if (!data.rates || !data.rates[targetCurrency]) {
                throw new Error(`âŒ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø³Ø¹Ø± ØµØ±Ù ${baseCurrency}/${targetCurrency}`);
            }

            const rate = data.rates[targetCurrency];
            resultElement.innerHTML = `
                <strong>ğŸ’± Ø³Ø¹Ø± Ø§Ù„ØµØ±Ù:</strong><br>
                1 ${baseCurrency} = <mark>${rate.toFixed(6)}</mark> ${targetCurrency}<br>
                <small>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ­Ø¯ÙŠØ«: ${new Date(data.date).toLocaleString()}</small>
            `;
            resultElement.style.color = "green";
        } 
        catch (error) {
            resultElement.textContent = error.message;
            resultElement.style.color = "red";
            console.error("ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø®Ø·Ø£:", error);
        }
    }

    // Ù…ØµØ¯Ø± Ø§Ø­ØªÙŠØ§Ø·ÙŠ Ø¥Ø°Ø§ ÙØ´Ù„ Ø§Ù„Ù…ØµØ¯Ø± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
    async function tryFallbackAPI(baseCurrency, targetCurrency) {
        const resultElement = document.getElementById("rateResult");
        try {
            // Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙˆØ§Ø¬Ù‡Ø© ExchangeRate-API ÙƒØ¨Ø¯ÙŠÙ„
            const url = `https://open.er-api.com/v6/latest/${baseCurrency}`;
            const response = await fetch(url);
            const data = await response.json();
            
            if (data.result === 'success' && data.rates[targetCurrency]) {
                const rate = data.rates[targetCurrency];
                resultElement.innerHTML = `
                    <strong>ğŸ’± Ø³Ø¹Ø± Ø§Ù„ØµØ±Ù (Ù…ØµØ¯Ø± Ø§Ø­ØªÙŠØ§Ø·ÙŠ):</strong><br>
                    1 ${baseCurrency} = <mark>${rate.toFixed(6)}</mark> ${targetCurrency}<br>
                    <small>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ­Ø¯ÙŠØ«: ${new Date(data.time_last_update_utc).toLocaleString()}</small>
                `;
                resultElement.style.color = "blue";
            } else {
                throw new Error("âŒ Ù„Ø§ ØªØªÙˆÙØ± Ø¨ÙŠØ§Ù†Ø§Øª Ø³Ø¹Ø± Ø§Ù„ØµØ±Ù");
            }
        } catch (fallbackError) {
            throw new Error("âŒ ÙØ´Ù„ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ØµØ§Ø¯Ø± Ø§Ù„Ù…ØªØ§Ø­Ø©");
        }
    }
</script>
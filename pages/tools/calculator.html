<h3>Ø§Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø© Ø§Ù„Ø­Ø³Ø§Ø¨ÙŠØ©:</h3>
<input type="text" id="inputField" placeholder="Ù…Ø«Ø§Ù„: 5 + 3 * 2" style="width: 300px;">
<button onclick="calculate()">ğŸ§® Ø§Ø­Ø³Ø¨</button>

<h4>Ø§Ù„Ù†ØªÙŠØ¬Ø©:</h4>
<label id="resultLabel">â€”</label>

<h4>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª:</h4>
<div id="historyContainer"
    style="border: 1px solid #ccc; padding: 10px; width: 320px; max-height: 200px; overflow-y: auto; background: #f9f9f9;">
</div>
<br>
<button onclick="clearHistory()">ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„ØªØ§Ø±ÙŠØ®</button>


<script>
    const inputField = document.getElementById( "inputField" );
    const resultLabel = document.getElementById( "resultLabel" );
    const historyContainer = document.getElementById( "historyContainer" );

    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³Ø¬Ù„ Ù…Ù† localStorage Ø¹Ù†Ø¯ Ø¨Ø¯Ø¡ Ø§Ù„ØµÙØ­Ø©

    async function loadHistory ()
    {
        const savedHistory = JSON.parse( localStorage.getItem( "calc_history" ) || "[]" );
        savedHistory.forEach( addToHistory );
    }


    function calculate ()
    {
        const expression = inputField.value.trim();

        // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø­Ù‚Ù„ Ù„Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ
        inputField.style.borderColor = "";

        if ( expression === "" )
        {
            resultLabel.textContent = "â€”";
            return;
        }

        try
        {
            const result = math.evaluate( expression );
            resultLabel.textContent = result;

            const newLine = `${ expression } = ${ result }`;

            // Ø¬Ù„Ø¨ Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ
            let currentHistory = JSON.parse( localStorage.getItem( "calc_history" ) || "[]" );

            // Ù…Ù†Ø¹ Ø§Ù„ØªÙƒØ±Ø§Ø±
            if ( currentHistory[ currentHistory.length - 1 ] !== newLine )
            {
                currentHistory.push( newLine );
                localStorage.setItem( "calc_history", JSON.stringify( currentHistory ) );
                addToHistory( newLine );
            }
        } catch ( err )
        {
            resultLabel.textContent = "âš ï¸ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø©";
            inputField.style.borderColor = "red";

            // Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø¢Ø®Ø± Ù…Ø¹Ø§Ø¯Ù„Ø© ØµØ­ÙŠØ­Ø©
            const lines = JSON.parse( localStorage.getItem( "calc_history" ) || "[]" );
            if ( lines.length > 0 )
            {
                const lastExpr = lines[ lines.length - 1 ].split( "=" )[ 0 ].trim();
                inputField.value = lastExpr;
            }
        }
    }

    function addToHistory ( text )
    {
        const item = document.createElement( "div" );
        item.textContent = text;
        item.style.cursor = "pointer";
        item.style.padding = "5px";
        item.style.borderBottom = "1px solid #ddd";
        item.addEventListener( "click", () =>
        {
            inputField.value = text.split( "=" )[ 0 ].trim();
            inputField.style.borderColor = ""; // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø£Ø­Ù…Ø± Ø¥Ù† ÙˆÙØ¬Ø¯
        } );
        historyContainer.appendChild( item );
        historyContainer.scrollTop = historyContainer.scrollHeight;
    }

    function clearHistory ()
    {
        localStorage.removeItem( "calc_history" );
        historyContainer.innerHTML = "";
        resultLabel.textContent = "â€”";
    }
</script>
<!--- ุฒุฑ ุฅุถุงูุฉ ุฏูุนุฉ ุฌุฏูุฏุฉ --->
<!-- ุฒุฑ ูุฅุถุงูุฉ ุฏูุนุฉ ุฌุฏูุฏุฉุ ุนูุฏ ุงูุถุบุท ุนููู ูุชู ุงุณุชุฏุนุงุก ุฏุงูุฉ addBill -->
<button onclick="addBill()">
    <img id="i_addBill" alt="addBill" style="width: 20px; height: 20px; vertical-align: middle; margin-left: 5px" />
    <br />
    <span id="t_1268"></span>
    <!-- ุณูุชู ุชุนุจุฆุชู ุจูุต ูุนุฑูุจ -->
</button>
<!-- ุฒุฑ ูุญุฐู ุงูุฏูุนุฉ ุงูุญุงููุฉุ ุนูุฏ ุงูุถุบุท ุนููู ูุชู ุงุณุชุฏุนุงุก ุฏุงูุฉ deletBill -->
<button onclick="deletBill()">
    <img id="i_delet" alt="addBill" style="width: 20px; height: 20px; vertical-align: middle; margin-left: 5px" />
    <br />
    <span id="t_214"></span>
    <!-- ุณูุชู ุชุนุจุฆุชู ุจูุต ูุนุฑูุจ -->
</button>
<!--- ุญุงููุฉ ุฃุฒุฑุงุฑ ุงูุฏูุนุงุช --->
<br /><br />
<div id="buttonsContainer"></div>

<br /><br />

<style>
    /* ุชุฎุตูุต ุดุฑูุท ุงูุชูุฑูุฑ ูุญุงููุฉ ุงูุฌุฏูู */
    #billContaner::-webkit-scrollbar {
        height: 5px;
    }

    #billContaner::-webkit-scrollbar-track {
        background: #f0f0f0;
        border-radius: 5px;
    }

    #billContaner::-webkit-scrollbar-thumb {
        background: linear-gradient(90deg, #3d3e3f, #3d3e3f);
        border-radius: 5px;
    }

    #billContaner::-webkit-scrollbar-thumb:hover {
        background: linear-gradient(90deg, #040404, #040404);
    }
</style>
<!--- ุญุงููุฉ ุงูุฌุฏูู --->
<div id="billContaner" style="max-width:100%;overflow-x: scroll;"></div>

<!-- ูุงูุจ ุงูุตููู ุงููุฎููุฉ ุงููุณุชุฎุฏูุฉ ููุณุฎ ุตููู ุงูุฌุฏูู -->
<div id="PandBillRaw" style="display: none;">
    <table>
        <thead class="hide-text">
            <tr>
                <!-- ุนูุงููู ุงูุฃุนูุฏุฉ (ุณูุชู ุชุนุจุฆุชูุง ุฏููุงููููุงู) -->
                <th id="t_37"></th>
                <th id="t_413"></th>
                <th id="t_112"></th>
                <th id="t_113"></th>
                <th id="t_114"></th>
                <th id="t_115"></th>
                <th id="t_116"></th>
                <th id="t_907"></th>
                <th id="t_93"></th>
                <th id="t_293"></th>
                <th id="t_861"></th>
                <th id="t_281"></th>
                <th id="t_39"></th>
                <th id="t_104"></th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <!-- ูู ุนููุฏ ูุญุชูู ุนูู input ุฃู select ุญุณุจ ููุน ุงูุจูุงูุงุช -->
                <td>
                    <input id="numbering" readonly type="text" placeholder=""
                        style="outline: none; border: none; background-color: transparent; color: black;" />
                </td>
                <td>
                    <input id="PandBillText" type="text" placeholder=""
                        style="border: none; background-color: transparent; color: black" />
                </td>
                <td>
                    <input id="PandBillNo" type="number" placeholder=""
                        style="border: none; background-color: transparent; color: black" />
                </td>
                <td>
                    <input id="PandBillLength" type="number" placeholder=""
                        style="border: none; background-color: transparent; color: black" />
                </td>
                <td>
                    <input id="PandBillWidth" type="number" placeholder=""
                        style="border: none; background-color: transparent; color: black" />
                </td>
                <td>
                    <input id="PandBillHight" type="number" placeholder=""
                        style="border: none; background-color: transparent; color: black" />
                </td>
                <td>
                    <input id="PandBillKg" type="number" placeholder=""
                        style="border: none; background-color: transparent; color: black" />
                </td>
                <td>
                    <select id="PandBillKindSum">
                        <option id="t_401" value="0"></option>
                        <option id="t_118" value="1"></option>
                    </select>
                </td>
                <td>
                    <input id="PandBillSum" readonly type="number" placeholder=""
                        style="outline: none; border: none; background-color: transparent; color: black;" />
                </td>
                <td>
                    <input id="PandBillStat" readonly type="text" placeholder=""
                        style="border: none; background-color: transparent; color: black" />
                </td>
                <td>
                    <select id="PandBillKindWork">
                        <option id="t_226" value="0"></option>
                        <option id="t_227" value="1"></option>
                    </select>
                </td>
                <td>
                    <input id="PandBillPercent" type="number" min="0" max="100" placeholder=""
                        style="outline: none; border: none; background-color: transparent; color: black;" />
                </td>
                <td>
                    <input id="PandBillPrice" readonly type="number" placeholder=""
                        style="outline: none; border: none; background-color: transparent; color: black;" />
                </td>
                <td>
                    <input id="PandBillNote" type="text" placeholder=""
                        style="outline: none; border: none; background-color: transparent; color: black;" />
                </td>
            </tr>
        </tbody>
    </table>
</div>

<!-- ุฌุฏูู ุงููุชุงุฆุฌ ุงูููุงุฆูุฉ -->
<div id="results">
    <br><br>
    <table>
        <!-- ุตููู ุงููุชุงุฆุฌ ุงูุฅุฌูุงููุฉ ููุฃุนูุงู ูุงูุชุดูููุงุช -->
        <tr>
            <td><label id="t_925"></label></td>
            <td><input id="TotalWorksAddition" type="text" readonly placeholder=""
                    style="outline: none; border: none; background-color: transparent; color: black;" /></td>
        </tr>
        <tr>
            <td><label id="t_926"></label></td>
            <td><input id="TotalWorksDiscount" type="text" readonly placeholder=""
                    style="outline: none; border: none; background-color: transparent; color: black;" /></td>
        </tr>
        <tr>
            <td><label id="t_929"></label></td>
            <td><input id="TotalWorks" type="text" readonly placeholder=""
                    style="outline: none; border: none; background-color: transparent; color: black;" /></td>
        </tr>
        <tr>
            <td><label id="t_927"></label></td>
            <td><input id="TotalSuppliesAddition" type="text" readonly placeholder=""
                    style="outline: none; border: none; background-color: transparent; color: black;" /></td>
        </tr>
        <tr>
            <td><label id="t_928"></label></td>
            <td><input id="TotalSuppliesDiscount" type="text" readonly placeholder=""
                    style="outline: none; border: none; background-color: transparent; color: black;" /></td>
        </tr>
        <tr>
            <td><label id="t_930"></label></td>
            <td><input id="TotalSupplies" type="text" readonly placeholder=""
                    style="outline: none; border: none; background-color: transparent; color: black;" /></td>
        </tr>
    </table>
    <br><br>
    <table>
        <thead>
            <tr style="text-align: center; vertical-align: middle;">
                <!-- ุนูุงููู ุงูุฃุนูุฏุฉ ููุฌุฏูู ุงูุชูุตููู -->
                <th id="t_293"></th>
                <th id="t_922"></th>
                <th id="t_39"></th>
                <th id="t_40"></th>
            </tr>
        </thead>
        <!-- ุตููู ุงููุชุงุฆุฌ ุงูุชูุตูููุฉ ููุฃุนูุงู ูุงูุชุดูููุงุช ุงูุณุงุจูุฉ ูุงูุญุงููุฉ -->
        <tr style="text-align: center; vertical-align: middle;">
            <td><label id="t_321"></label></td>
            <td>
                <input id="PreviousWorksValue" type="text" readonly placeholder=""
                    style="outline: none; border: none; background-color: transparent; color: black; max-width: 50px; min-width:  50px;" />
                <input id="PreviousWorksPercent" type="text" readonly placeholder=""
                    style="outline: none; border: none; background-color: transparent; color: black; max-width: 50px; min-width:  50px;" />
            </td>
            <td><label id="priceWork"></label></td>
            <td>
                <input id="PreviousWorksTotalCost" type="text" readonly placeholder=""
                    style="outline: none; border: none; background-color: transparent; color: black; max-width: 50px; min-width:  50px;" />
            </td>
        </tr>
        <tr style="text-align: center; vertical-align: middle;">
            <td><label id="t_320"></label></td>
            <td>
                <input id="CurrentWorksValue" type="text" readonly placeholder=""
                    style="outline: none; border: none; background-color: transparent; color: black; max-width: 50px; min-width:  50px;" />
                <input id="CurrentWorksPercent" type="text" readonly placeholder=""
                    style="outline: none; border: none; background-color: transparent; color: black; max-width: 50px; min-width:  50px;" />
            </td>
            <td><label id="priceWork"></label></td>
            <td>
                <input id="CurrentWorksTotalCost" type="text" readonly placeholder=""
                    style="outline: none; border: none; background-color: transparent; color: black; max-width: 50px; min-width:  50px;" />
            </td>
        </tr>
        <tr style="text-align: center; vertical-align: middle;">
            <td><label id="t_323"></label></td>
            <td>
                <input id="TotalExecutedWorks" type="text" readonly placeholder=""
                    style="outline: none; border: none; background-color: transparent; color: black;" />
            </td>
            <td><label id="priceWork"></label></td>
            <td></td>
        </tr>
        <tr style="text-align: center; vertical-align: middle;">
            <td><label id="t_920"></label></td>
            <td>
                <input id="PreviousSupplies" type="text" readonly placeholder=""
                    style="outline: none; border: none; background-color: transparent; color: black;" />
            </td>
            <td></td>
            <td></td>
        </tr>
        <tr style="text-align: center; vertical-align: middle;">
            <td><label id="t_919"></label></td>
            <td>
                <input id="CurrentSuppliesValue" type="text" readonly placeholder=""
                    style="outline: none; border: none; background-color: transparent; color: black; max-width: 50px; min-width:  50px;" />
                <input id="CurrentSuppliesPercent" type="text" readonly placeholder=""
                    style="outline: none; border: none; background-color: transparent; color: black; max-width: 50px; min-width:  50px;" />
            </td>
            <td>
                <input id="CurrentSuppliesPrice" type="text" readonly placeholder=""
                    style="outline: none; border: none; background-color: transparent; color: black; max-width: 50px; min-width:  50px;" />
            </td>
            <td>
                <input id="CurrentSuppliesTotalCost" type="text" readonly placeholder=""
                    style="outline: none; border: none; background-color: transparent; color: black; max-width: 50px; min-width:  50px;" />
            </td>
        </tr>
        <tr style="text-align: center; vertical-align: middle;">
            <td><label id="t_921"></label></td>
            <td>
                <input id="TotalExecutedSupplies" type="text" readonly placeholder=""
                    style="outline: none; border: none; background-color: transparent; color: black;" />
            </td>
            <td></td>
            <td></td>
        </tr>
    </table>
</div>

<script>

    // ๐ก ุชุนุฑูู ุงููุชุบูุฑุงุช ุงูุนุงูุฉ - ุชู ููููุง ุฅูู ููู ุงูุฃุฏูุงุช

    /**
     * ุฏุงูุฉ ููุณุญ ุฌููุน ุฃุฒุฑุงุฑ ุงูุฏูุนุงุช ูู ุงููุงุฌูุฉ ูุฅุนุงุฏุฉ ุชุนููู ูุฌููุนุฉ ุงููุคุดุฑุงุช
     */
    function clearAllButtons ()
    {
        // ุชูุฑูุบ ุงูุญุงููุฉ ูู ุงูุฃุฒุฑุงุฑ
        document.getElementById( "buttonsContainer" ).innerHTML = "";
        // ุฅุนุงุฏุฉ ุชุนููู ูุฌููุนุฉ ุงููุคุดุฑุงุช (ูููุน ุชูุฑุงุฑ ุงูุฃุฒุฑุงุฑ)
        buttonShowIndexSet.clear();
    }

    /**
     * ุฏุงูุฉ ุฅุถุงูุฉ ุฏูุนุฉ ุฌุฏูุฏุฉ ุนูุฏ ุงูุถุบุท ุนูู ุฒุฑ "ุฅุถุงูุฉ ุญุตุฑ"
     * ุชููู ุจุชููุฆุฉ ุงูุตูุญุฉ ุซู ุฅุถุงูุฉ ุฒุฑ ุฌุฏูุฏ ููุฏูุนุฉ ุงูุชุงููุฉ
     */
    async function addBill ()
    {
        try
        {
            // ุชููุฆุฉ ุตูุญุฉ ุงูุญุตุฑ (ุชุญููู ุงูุจูุงูุงุช ุงูุณุงุจูุฉ)
            await initPandBillPage();
            // ุฒูุงุฏุฉ ุฑูู ุขุฎุฑ ุฏูุนุฉ
            lastBill += 1;
            // ุฅุถุงูุฉ ุฒุฑ ุฌุฏูุฏ ููุฏูุนุฉ ุงูุชุงููุฉ
            await addButton( lastBill );
        } catch ( error )
        {
            // ุทุจุงุนุฉ ุงูุฎุทุฃ ูู ูุญุฏุฉ ุงูุชุญูู
            console.error( "โ ุฎุทุฃ ูู addBill:", error );
        }
    }

    /**
     * ุฏุงูุฉ ุญุฐู ุงูุฏูุนุฉ ุงูุญุงููุฉ ุนูุฏ ุงูุถุบุท ุนูู ุฒุฑ ุงูุญุฐู
     * ุชููู ุจุญุฐู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุฎุงุตุฉ ุจุงูุฏูุนุฉ ุงูุฃุฎูุฑุฉ ูุชูุฑูุบ ุงูุญุงููุฉ
     */
    async function deletBill ()
    {
        try
        {
            // ุญุฐู ูุงุนุฏุฉ ุจูุงูุงุช ุงูุฏูุนุฉ ุงูุฃุฎูุฑุฉ
            await deleteDatabase( "bill_" + lastBill + "_" + selectedPandId );
            // ูุณุญ ุฌููุน ุงูุฃุฒุฑุงุฑ
            clearAllButtons();
            // ุฅุนุงุฏุฉ ุชููุฆุฉ ุงูุตูุญุฉ
            await initPandBillPage();
            // ุชูุฑูุบ ุญุงููุฉ ุงูุฌุฏูู
            document.getElementById( "billContaner" ).innerHTML = "";
        } catch ( error )
        {
            // ุทุจุงุนุฉ ุงูุฎุทุฃ ูู ูุญุฏุฉ ุงูุชุญูู
            console.error( "โ ุฎุทุฃ ูู deletBill:", error );
        }
    }

    /**
     * ุฏุงูุฉ ุชุญููู ููุงุนุฏ ุงูุจูุงูุงุช ุงูุณุงุจูุฉ ูุฅุธูุงุฑ ุฃุฒุฑุงุฑูุง
     * ุชููู ุจุงูุจุญุซ ุนู ููุงุนุฏ ุงูุจูุงูุงุช ุญุชู 100 ุฏูุนุฉ ูุชุถูู ุงูุฃุฒุฑุงุฑ ุงูููุงุจูุฉ ููุง
     */
    async function initPandBillPage ()
    {
        try
        {
            lastBill = 0;
            let i = 1;
            // ุญููุฉ ููุจุญุซ ุนู ููุงุนุฏ ุงูุจูุงูุงุช ุญุชู 100 ุฏูุนุฉ ูุญุฏ ุฃูุตู
            while ( i <= 100 )
            {
                // ุงุณู ูุงุนุฏุฉ ุงูุจูุงูุงุช
                const dbName = "bill_" + i + "_" + selectedPandId;
                // ุงูุชุญูู ูู ูุฌูุฏ ูุงุนุฏุฉ ุงูุจูุงูุงุช
                const exists = await checkDatabaseExists( dbName );
                if ( exists )
                {
                    // ุฅุถุงูุฉ ุฒุฑ ููุฏูุนุฉ
                    await addButton( i );
                    // ุชุญุฏูุซ ุฑูู ุขุฎุฑ ุฏูุนุฉ
                    lastBill = i;
                    i++;
                } else
                {
                    // ุงูุชููู ุฅุฐุง ูู ุชูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ููุฌูุฏุฉ
                    break;
                }
            }
        } catch ( error )
        {
            // ุทุจุงุนุฉ ุงูุฎุทุฃ ูู ูุญุฏุฉ ุงูุชุญูู
            console.error( "โ ุฎุทุฃ ูู initPandBillPage:", error );
        }
    }

    /**
     * ุฏุงูุฉ ุฅูุดุงุก ุฒุฑ ุฌุฏูุฏ ููุซู ุฏูุนุฉ ูุนููุฉ
     * @param {number} billIndex ุฑูู ุงูุฏูุนุฉ
     */
    async function addButton ( billIndex )
    {
        try
        {
            // ุงูุชุญูู ูู ุนุฏู ุชูุฑุงุฑ ุงูุฒุฑ
            if ( buttonShowIndexSet.has( billIndex ) )
            {
                return;
            } else
            {
                // ุชุณุฌูู ุงููุคุดุฑ ูู ุงููุฌููุนุฉ
                buttonShowIndexSet.add( billIndex );
            }

            // ุฅูุดุงุก ุนูุตุฑ ุงูุฒุฑ
            const button = document.createElement( "button" );
            button.id = "BillB_" + billIndex;
            // ุนูุฏ ุงูุถุบุท ุนูู ุงูุฒุฑ ูุชู ุชุญููู ุจูุงูุงุช ุงูุฏูุนุฉ
            button.onclick = async function ()
            {
                await addPandBillDatabase( billIndex );
            };
            button.style.margin = "5px";

            // ุฅุถุงูุฉ ุตูุฑุฉ ููุฒุฑ
            const img = document.createElement( "img" );
            img.alt = "Bill";
            img.id = "i_bill";
            img.style.width = "20px";
            img.style.height = "20px";
            img.style.verticalAlign = "middle";
            img.style.marginLeft = "5px";

            button.appendChild( img );
            button.appendChild( document.createElement( "br" ) );

            // ุฅุถุงูุฉ ูุต ูุนุฑู ุงูุฒุฑ
            const span = document.createElement( "span" );
            span.id = "t_1065_" + billIndex;
            button.appendChild( span );

            // ุฅุถุงูุฉ ุงูุฒุฑ ุฅูู ุงูุญุงููุฉ
            document.getElementById( "buttonsContainer" ).appendChild( button );

            // ุชุญุฏูุซ ุงูุชุฑุฌูุฉ ูุงูุตูุฑ
            await setTextAndImage();

            // ุฅุถุงูุฉ ุฑูู ุงูุฏูุนุฉ ุจุฌุงูุจ ุงูุฒุฑ
            const spanNum = document.createElement( "span" );
            spanNum.innerText = " " + billIndex;
            button.appendChild( spanNum );

        } catch ( error )
        {
            // ุทุจุงุนุฉ ุงูุฎุทุฃ ูู ูุญุฏุฉ ุงูุชุญูู
            console.error( "โ ุฎุทุฃ ูู addButton:", error );
        }
    }

    // ูุชุบูุฑ ูููุน ุชูุฑุงุฑ ุชูููุฐ ุฏุงูุฉ addPandBillDatabase ูู ููุณ ุงูููุช
    let stopAddPandBillDatabase = false;

    /**
     * ุฏุงูุฉ ุฅูุดุงุก ูุงุนุฏุฉ ุจูุงูุงุช ูุฌุฏูู ูุฏูุนุฉ ูุนููุฉ
     * ูุชู ุงูุชูููุฐ ุนูุฏ ุงูุถุบุท ุนูู ุฃุญุฏ ุงูุฃุฒุฑุงุฑ ุงูุฎุงุตุฉ ุจุฏูุนุฉ ูุนููุฉ
     * @param {number} dataBaseIndex ุฑูู ุงูุฏูุนุฉ
     */
    async function addPandBillDatabase ( dataBaseIndex )
    {
        try
        {
            // ุฅุนุงุฏุฉ ุชุนููู ูุนุฑู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุณุงุจูุฉ
            dataBaseIdForPandBillPrevious = null;
            // ููุน ุชูุฑุงุฑ ุงูุชูููุฐ
            if ( stopAddPandBillDatabase == true ) { return; }
            stopAddPandBillDatabase = true;
            // ุชุนุทูู ูุฑุงูุจุฉ ุงูุฌุฏูู ูุคูุชุงู
            isTableWatcherEnabled = false;
            // ุชุนููู ุงุณู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุญุงููุฉ
            dataBaseIdForPandBill = "bill_" + dataBaseIndex + "_" + selectedPandId;

            // ูุญุงููุฉ ุญุฐู ุงูุฌุฏูู ุงูุณุงุจู (ุฅู ููุฌุฏ)
            try
            {
                await PandBillTable.destroyTable();
            } catch ( error )
            {
                // ุชุฌุงูู ุงูุฎุทุฃ ุฅุฐุง ูู ููู ููุงู ุฌุฏูู ููุฌูุฏ ูุณุจูุงู
            }

            // ุฅุฐุง ูุงู ุฑูู ุงูุฏูุนุฉ ุฃูุจุฑ ูู 1ุ ุชุนููู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุณุงุจูุฉ
            if ( Number( dataBaseIndex ) > 1 )
            {
                dataBaseIdForPandBillPrevious = "bill_" + ( Number( dataBaseIndex ) - 1 ) + "_" + selectedPandId;
                //ุชุตุฏูุฑ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุณุงุจูุฉ
             if( await  checkDatabaseExists(dataBaseIdForPandBill)==false)
             {
                const backup = await exportEntireDatabase( dataBaseIdForPandBillPrevious );
                backup.database = dataBaseIdForPandBill;
                await importOrUpdateFromJSON( backup );
             }
            }
            // ุฅูุดุงุก ูุงุฆู ูุงุนุฏุฉ ุจูุงูุงุช ุจุฏูู ุชุฑููุฉ
            dbNoUp_PandBill = await new noUpgrade( dataBaseIdForPandBill );
            if ( Number( dataBaseIndex ) > 1 )
            {
                dbNoUp_PandBillPrevious = await new noUpgrade( dataBaseIdForPandBillPrevious );
            }
            // ุฅุฐุง ูู ููู ุฌุฏูู ุงููุชุงุฆุฌ ููุฌูุฏุงูุ ูุชู ุฅูุดุงุคู
            if ( await dbNoUp_PandBill.isTableExist( "resultsTable" ) == false )
            {
                let dbUp_PandBill = await new upgrade( dataBaseIdForPandBill );
                await dbUp_PandBill.createKeyTable( "resultsTable" );
                dbNoUp_PandBill = await new noUpgrade( dataBaseIdForPandBill );
                if ( Number( dataBaseIndex ) > 1 )
                {
                    dbNoUp_PandBillPrevious = await new noUpgrade( dataBaseIdForPandBillPrevious );
                }
            }

            // ุฅูุดุงุก ูุงุฆู ุฌุฏูุฏ ููุฌุฏูู ูุน ุงููุนุงููุงุช ุงููุทููุจุฉ
            PandBillTable = new setTableParameter(
                "billContaner", // ุญุงููุฉ ุงูุฌุฏูู
                dataBaseIdForPandBill, // ุงุณู ูุงุนุฏุฉ ุงูุจูุงูุงุช
                "PandBillRaw", // ูุงูุจ ุงูุตููู
                "", // ุตู ุจุฏูู (ุบูุฑ ูุณุชุฎุฏู ุญุงููุงู)
                true, // ุฅุธูุงุฑ ุงูุนููุงู
                false, // ุนุฏู ุฅุถุงูุฉ ุตู ุจุงูููุฑ
                true, // ุจุฏุก ุจุตู ุฌุฏูุฏ
                true // ุชุฑููู ุงูุตููู
            );

            // ุชุนููู ุงูููู ุงูุงูุชุฑุงุถูุฉ ูุชุญููู ุงูููู ุงููุฎุฒูุฉ
            await initialValues();

        } catch ( error )
        {
            // ุทุจุงุนุฉ ุงูุฎุทุฃ ูู ูุญุฏุฉ ุงูุชุญูู
            console.error( "โ ุฎุทุฃ ูู addPandBillDatabase:", error );
        } finally
        {
            // ุฅุนุงุฏุฉ ุชูุนูู ุงูุชูููุฐ ููุฑุงูุจุฉ ุงูุฌุฏูู
            stopAddPandBillDatabase = false;
            isTableWatcherEnabled = true;
        }
    }

    /**
     * ุฏุงูุฉ ููุชุญูู ุฅุฐุง ูุงู ููุงู ูููุฉ ุฑูููุฉ ูู ูุตูููุฉ
     * @param {Array} array ูุตูููุฉ ุงูููู
     * @returns {boolean} ูู ููุฌุฏ ูููุฉ ุฑูููุฉ ุฃู ูุง
     */
    function hasNumericValue ( array )
    {
        return array.some( isNumeric );
    }

    // ูุงุฆูุฉ ุงูุญููู ุงูุชู ุชุฏุฎู ูู ุญุณุงุจ ุญุงุตู ุงูุถุฑุจ
    let sumList = [
        "PandBillNo",
        "PandBillLength",
        "PandBillWidth",
        "PandBillHight",
        "PandBillKg"
    ];
    // ูุชุบูุฑ ูููุน ุชูุฑุงุฑ ุชูููุฐ ุฏุงูุฉ calSumBillSection
    let isCalSumBillSectionRunning = false;

    /**
     * ุฏุงูุฉ ูุญุณุงุจ ุญุงุตู ุถุฑุจ ุงูููู ูู ุตู ูุนูู ูุชุญุฏูุซ ุญูู ุงููุฌููุน
     * @param {string} dataName ุงุณู ุงูุญูู (ุบูุฑ ูุณุชุฎุฏู ููุง)
     * @param {string} tableId ูุนุฑู ุงูุตู
     */
    async function calSumBillSection ( dataName, tableId )
    {
        try
        {
            // ููุน ุชูุฑุงุฑ ุงูุชูููุฐ
            if ( isCalSumBillSectionRunning )
            {
                return;
            }

            isCalSumBillSectionRunning = true;
            isTableWatcherEnabled = false;

            // ุงูุชุญูู ูู ุตุญุฉ ูุนุฑู ุงูุตู
            if ( isValidIdFormat( tableId ) )
            {
                let value = [];
                let valueCheck = [];
                let key = null;
                // ุฌูุจ ุงูููู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
                for ( let i = 0; i < sumList.length; i++ )
                {
                    key = sumList[ i ];
                    const valueูู = await dbNoUp_PandBill.keyGet( tableId, key );
                    valueCheck.push( valueูู );
                }
                let product = 1;
                // ุฅุฐุง ูู ุชูุฌุฏ ุฃู ูููุฉ ุฑูููุฉุ ุงููุงุชุฌ ุตูุฑ
                if ( !hasNumericValue( valueCheck ) )
                {
                    product = 0;
                }
                else
                {
                    // ุชุนููุถ ุงูููู ุงููุงุฑุบุฉ ุจู 1
                    for ( let i = 0; i < sumList.length; i++ )
                    {
                        let val = valueCheck[ i ];
                        if ( val == null || val === "" )
                        {
                            val = 1;
                        }
                        value[ i ] = val;
                    }
                    // ุญุณุงุจ ุญุงุตู ุงูุถุฑุจ
                    for ( let i = 0; i < value.length; i++ )
                    {
                        product *= Number( value[ i ] );
                    }
                    // ุฅุฐุง ูุงู ููุน ุงูุชุฌููุน ุฎุตูุ ุงุถุฑุจ ูู -1
                    if ( await dbNoUp_PandBill.keyGet( tableId, 'PandBillKindSum' ) == '1' )
                    {
                        product *= -1;
                    }
                }
                // ุชุญุฏูุฏ ุญุงูุฉ ุนูุตุฑ ุงูุณุนุฑ ุฅุฐุง ูุงู ูุงุจู ููุฅุฏุฎุงู ุฃู ูุง
                if ( await dbNoUp_PandBill.keyGet( tableId, 'PandBillKindWork' ) == '0' )
                {
                    await isPriceEdit( tableId, 0 );
                }
                else
                {
                    await isPriceEdit( tableId, 1 );
                }
                // ุชุญุฏูุซ ูููุฉ ุงููุฌููุน ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุงูุนูุตุฑ
                await dbNoUp_PandBill.keySet( tableId, "PandBillSum", product );
                const raw_ = document.getElementById( tableId + "_" );
                const tot_ = raw_.querySelector( "#PandBillSum" );
                tot_.value = ( product ).toFixed( DecimalPoint );
                // ุชุญุฏูุซ ุงููุฌุงููุน ุงููููุฉ
                await calSumBill0( dbNoUp_PandBill );
            }

            isTableWatcherEnabled = true;
        } catch ( error )
        {
            // ุทุจุงุนุฉ ุงูุฎุทุฃ ูู ูุญุฏุฉ ุงูุชุญูู
            console.error( "Error calculating calSumBillSection:", error );
        } finally
        {
            isCalSumBillSectionRunning = false;
            isTableWatcherEnabled = true;
        }
    }

    // ูุชุบูุฑ ูููุน ุชูุฑุงุฑ ุชูููุฐ ุฏุงูุฉ calSumBill0
    let isCalScalSumBill0Running = false;

    /**
     * ุฏุงูุฉ ูุญุณุงุจ ุงููุฌุงููุน ุงููููุฉ ููุฃุนูุงู ูุงูุชุดูููุงุช ูุชุญุฏูุซ ุงููุชุงุฆุฌ ูู ุงูุตูุญุฉ
     * @param {object} dbNoUp_PandBill ูุงุฆู ูุงุนุฏุฉ ุงูุจูุงูุงุช
     */
    async function calSumBill0 ( dbNoUp_PandBill )
    {
        try
        {

            //#region ููุน ุชูุฑุงุฑ ุงูุชูููุฐ
            if ( isCalScalSumBill0Running )
            {
                return;
            }
            isCalScalSumBill0Running = true;
            //#endregion

            //#region ุฌูุจ ุฌููุน ุงูุตููู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
            let allRows = await dbNoUp_PandBill.getAllDataFromTable( "rows" );
            if ( !Array.isArray( allRows ) )
            {
                return;
            }
            //#endregion

            //#region ุชุนุฑูู ูุตูููุงุช ูุชุฌููุน ุงูููู ุญุณุจ ุงูููุน
            let sumCurrentWorksValue = [];
            let sumCurrentWorksPercent = [];
            let sumTotalWorksAddition = [];
            let sumTotalWorksDiscount = [];

            let sumCurrentSuppliesValue = [];
            let sumCurrentSuppliesPercent = [];
            let sumCurrentSuppliesPrices = [];
            let sumTotalSuppliesAddition = [];
            let sumTotalSuppliesDiscount = [];
            //#endregion

            //#region ุงููุฑูุฑ ุนูู ูู ุตู ูุชุฌููุน ุงูููู ุญุณุจ ุงูููุน ูุงูุญุงูุฉ
            for ( const rawId of allRows )
            {
                // ุฅุฐุง ูุงู ููุน ุงูุนูู "ุชูููุฐู"
                if ( await dbNoUp_PandBill.keyGet( rawId.key, "PandBillKindWork" ) == "0" )
                {
                    // ุฅุฐุง ูุงู ููุน ุงูุนูู "ุฌุฏูุฏ"
                    if ( await dbNoUp_PandBill.keyGet( rawId.key, "PandBillStat" ) == getLang( 685 ) )
                    {
                        sumCurrentWorksValue.push( await dbNoUp_PandBill.keyGet( rawId.key, "PandBillSum" ) );
                        sumCurrentWorksPercent.push( await dbNoUp_PandBill.keyGet( rawId.key, "PandBillPercent" ) );
                        // ุฅุฐุง ูุงู ููุน ุงูุชุฌููุน "ุฅุถุงูุฉ"
                        if ( await dbNoUp_PandBill.keyGet( rawId.key, "PandBillKindSum" ) == "0" )
                        {
                            sumTotalWorksAddition.push( await dbNoUp_PandBill.keyGet( rawId.key, "PandBillSum" ) );
                        }
                        else
                        {
                            sumTotalWorksDiscount.push( await dbNoUp_PandBill.keyGet( rawId.key, "PandBillSum" ) );
                        }
                    }
                }
                // ุฅุฐุง ูุงู ููุน ุงูุนูู "ุชุดูููุงุช"
                else
                {
                    // ุฅุฐุง ูุงู ููุน ุงูุนูู "ุฌุฏูุฏ"
                    if ( await dbNoUp_PandBill.keyGet( rawId.key, "PandBillStat" ) == getLang( 685 ) )
                    {
                        sumCurrentSuppliesValue.push( await dbNoUp_PandBill.keyGet( rawId.key, "PandBillSum" ) );
                        sumCurrentSuppliesPercent.push( await dbNoUp_PandBill.keyGet( rawId.key, "PandBillPercent" ) );
                        sumCurrentSuppliesPrices.push( await dbNoUp_PandBill.keyGet( rawId.key, "PandBillPrice" ) );

                        // ุฅุฐุง ูุงู ููุน ุงูุชุฌููุน "ุฅุถุงูุฉ"
                        if ( await dbNoUp_PandBill.keyGet( rawId.key, "PandBillKindSum" ) == "0" )
                        {
                            sumTotalSuppliesAddition.push( await dbNoUp_PandBill.keyGet( rawId.key, "PandBillSum" ) );
                        }
                        else
                        {
                            sumTotalSuppliesDiscount.push( await dbNoUp_PandBill.keyGet( rawId.key, "PandBillSum" ) );
                        }
                    }
                }
            }
            //#endregion

            //#region ุญุณุงุจ ุงูููู ุงููููุฉ ูุงููุณุจ ุงููููุฉ ููุฃุนูุงู ูุงูุชุดูููุงุช
            const resultWorks = calculateTotalValuPercent( sumCurrentWorksValue, sumCurrentWorksPercent );
            const resultSuplies = calculateSuppliesPercentprice( sumCurrentSuppliesValue, sumCurrentSuppliesPercent, sumCurrentSuppliesPrices );
            //#endregion

            //#region  ุฌูุจ ุนูุงุตุฑ ุงูุตูุญุฉ ุงูุชู ุณูุชู ูุถุน ุงููุชุงุฆุฌ ูููุง
            const CurrentWorksValue = document.getElementById( 'CurrentWorksValue' );
            const CurrentWorksPercent = document.getElementById( 'CurrentWorksPercent' );
            const CurrentWorksTotalCost = document.getElementById( 'CurrentWorksTotalCost' );
            const TotalWorks = document.getElementById( 'TotalWorks' );
            const TotalWorksAddition = document.getElementById( 'TotalWorksAddition' );
            const TotalWorksDiscount = document.getElementById( 'TotalWorksDiscount' );

            const CurrentSuppliesValue = document.getElementById( 'CurrentSuppliesValue' );
            const CurrentSuppliesPercent = document.getElementById( 'CurrentSuppliesPercent' );
            const CurrentSuppliesTotalCost = document.getElementById( 'CurrentSuppliesTotalCost' );
            const TotalSupplies = document.getElementById( 'TotalSupplies' );
            const TotalSuppliesAddition = document.getElementById( "TotalSuppliesAddition" );
            const TotalSuppliesDiscount = document.getElementById( 'TotalSuppliesDiscount' );
            const CurrentSuppliesPrice = document.getElementById( 'CurrentSuppliesPrice' );
            //#endregion

            //#region ูุถุน ุงูููู ูู ุงูุนูุงุตุฑ
            TotalWorks.value = resultWorks.totalValue;
            CurrentWorksValue.value = resultWorks.totalValue;
            CurrentWorksPercent.value = ( resultWorks.overallPercent ).toFixed( DecimalPoint );
            CurrentWorksTotalCost.value = ( ( resultWorks.overallPercent / 100 ) * resultWorks.totalValue * Number( pandPrice ) ).toFixed( DecimalPoint );
            TotalWorksAddition.value = sumTotalWorksAddition.reduce( ( acc, val ) => acc + val, 0 );
            TotalWorksDiscount.value = sumTotalWorksDiscount.reduce( ( acc, val ) => acc + val, 0 );

            TotalSupplies.value = Number( resultSuplies.valueSum ).toFixed( DecimalPoint );
            CurrentSuppliesValue.value = Number( resultSuplies.valueSum ).toFixed( DecimalPoint );
            CurrentSuppliesPercent.value = Number( resultSuplies.foundPercent ).toFixed( DecimalPoint );
            CurrentSuppliesTotalCost.value = ( ( Number( resultSuplies.foundPercent ) / 100 ) * Number( resultSuplies.valueSum ) * Number( resultSuplies.foundPrice ) ).toFixed( DecimalPoint );
            TotalSuppliesAddition.value = sumTotalSuppliesAddition.reduce( ( acc, val ) => acc + val, 0 );
            TotalSuppliesDiscount.value = sumTotalSuppliesDiscount.reduce( ( acc, val ) => acc + val, 0 );
            CurrentSuppliesPrice.value = Number( resultSuplies.foundPrice ).toFixed( DecimalPoint );
            //#endregion

            //#region ุฅุทูุงู ุญุฏุซ ุงูุชุบููุฑ ูุฏูููุง ููู ูุชู ุงูุญูุธ
            const inputEvent = new Event( 'input', { bubbles: true } );
            CurrentWorksValue.dispatchEvent( inputEvent );
            CurrentWorksPercent.dispatchEvent( inputEvent );
            CurrentWorksTotalCost.dispatchEvent( inputEvent );
            TotalWorks.dispatchEvent( inputEvent );
            TotalWorksAddition.dispatchEvent( inputEvent );
            TotalWorksDiscount.dispatchEvent( inputEvent );

            TotalSupplies.dispatchEvent( inputEvent );
            CurrentSuppliesValue.dispatchEvent( inputEvent );
            CurrentSuppliesPercent.dispatchEvent( inputEvent );
            CurrentSuppliesTotalCost.dispatchEvent( inputEvent );
            TotalSuppliesAddition.dispatchEvent( inputEvent );
            TotalSuppliesDiscount.dispatchEvent( inputEvent );
            CurrentSuppliesPrice.dispatchEvent( inputEvent );
            //#endregion

        } catch ( error )
        {
            // ุทุจุงุนุฉ ุงูุฎุทุฃ ูู ูุญุฏุฉ ุงูุชุญูู
            console.error( "Error calculating calSumBill0: ", error );
        } finally
        {
            isCalScalSumBill0Running = false;
        }
    }

    /**
     * ุฏุงูุฉ ูุญุณุงุจ ุงููููุฉ ุงููููุฉ ูุงููุณุจุฉ ุงููููุฉ ูู ูุตูููุชูู
     * @param {Array} value ูุตูููุฉ ุงูููู
     * @param {Array} percent ูุตูููุฉ ุงููุณุจ
     * @returns {object} ูุงุฆู ูุญุชูู ุนูู ุงููููุฉ ุงููููุฉ ูุงููุณุจุฉ ุงููููุฉ
     */
    function calculateTotalValuPercent ( value, percent )
    {
        let totalW = 0;
        let totalValue = 0;

        for ( let i = 0; i < value.length; i++ )
        {
            const val = Number( value[ i ] );
            const pct = Number( percent[ i ] );

            totalW += val * pct;
            totalValue += val;
        }

        const overallPercent = totalValue !== 0 ? totalW / totalValue : 0;

        return {
            totalValue,
            overallPercent
        };
    }

    function calculateSuppliesPercentprice ( values, percents, prices )
    {
        if ( values.length !== percents.length || values.length !== prices.length )
        {
            throw new Error( "ุฌููุน ุงููุตูููุงุช ูุฌุจ ุฃู ุชููู ุจุทูู ูุชุณุงูู." );
        }

        let totalSum = 0;
        let valueSum = 0;
        let weightedPriceSum = 0;

        for ( let i = 0; i < values.length; i++ )
        {
            totalSum += values[ i ] * ( percents[ i ] / 100 ) * prices[ i ];
            valueSum += values[ i ];
            weightedPriceSum += prices[ i ] * values[ i ];
        }

        // ุญุณุงุจ ุงูุณุนุฑ ุงูููุญุฏ ููุชูุณุท ูุฑุฌุญ ููุฃุณุนุงุฑ
        let foundPrice = weightedPriceSum / valueSum;

        // ุญุณุงุจ ุงููุณุจุฉ ุงูููุญุฏุฉ ุจูุงุกู ุนูู ุงููุนุงุฏูุฉ
        let foundPercent = ( totalSum / ( foundPrice * valueSum ) ) * 100;

        // ุถุจุท ุงููุณุจุฉ ุถูู ุงููุฌุงู [1, 100]
        if ( foundPercent > 100 ) foundPercent = 100;
        if ( foundPercent < 1 ) foundPercent = 1;

        // ุญุณุงุจ ุงูุณุนุฑ ุงูููุญุฏ ุงูููุงุฆู ุจูุงุกู ุนูู ุงููุณุจุฉ ุงููุตุญุญุฉ
        foundPrice = totalSum / ( ( foundPercent / 100 ) * valueSum );

        return {
            totalSum: totalSum.toFixed( 2 ),
            valueSum: valueSum,
            foundPercent: foundPercent.toFixed( 2 ),
            foundPrice: foundPrice.toFixed( 3 ),
            checkTotal: ( foundPrice * ( foundPercent / 100 ) * valueSum ).toFixed( 2 )
        };
    }

    /**
     * ุฏุงูุฉ ููุถุน ุงูููู ุงูุงูุชุฑุงุถูุฉ ูุฌูุจ ุงูููู ุงููุฎุฒูุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
     * ุชููู ุจุชุญุฏูุซ ุฌููุน ุงูุญููู ูู ุงูุฌุฏูู ุญุณุจ ุงูููู ุงููุฎุฒูุฉ ุฃู ุชุนููู ุงูููู ุงูุงูุชุฑุงุถูุฉ
     */
    async function initialValues ()
    {
        try
        {
            // ุชุนุทูู ูุฑุงูุจุฉ ุงูุฌุฏูู ูุคูุชุงู
            isTableWatcherEnabled = false;

            // ุชุนููู ุงูููู ุงูุฃุณุงุณูุฉ
            const statPrevText = getLang( 292 );
            const maxAttempts = 20;
            let allRows;
            let attempt = 0;

            // ูุญุงููุฉ ุชุญููู ุงูุจูุงูุงุช ูู ุงูุฌุฏูู (ุจุญุฏ ุฃูุตู 20 ูุญุงููุฉ)
            while ( attempt < maxAttempts )
            {
                allRows = await dbNoUp_PandBill.getAllDataFromTable( "rows" );
                if ( Array.isArray( allRows ) ) break;
                await delay( 100 );
                attempt++;
            }

            if ( !Array.isArray( allRows ) )
            {
                isTableWatcherEnabled = true;
                return;
            }

            // ูุนุงูุฌุฉ ูู ุตู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
            for ( const rawId of allRows )
            {
                await waitForElement( `#${ rawId.key }_` );
                const state = await dbNoUp_PandBill.keyGet( rawId.key, "PandBillStat" );
                const percent = await dbNoUp_PandBill.keyGet( rawId.key, "PandBillPercent" );
                const price = await dbNoUp_PandBill.keyGet( rawId.key, "PandBillPrice" );
                const PandBillKindWork = await dbNoUp_PandBill.keyGet( rawId.key, "PandBillKindWork" );
                const PandBillKindSum = await dbNoUp_PandBill.keyGet( rawId.key, "PandBillKindSum" );

                // ุชุญุฏูุซ ุงูุญุงูุฉ ุฅุฐุง ูุงูุช ุบูุฑ ูุทุงุจูุฉ ูููุต ุงููุชููุน
                if ( state == null || state === "" || state !== statPrevText )
                {
                    await dbNoUp_PandBill.keySet( rawId.key, "PandBillStat", getLang( 685 ) );
                }

                // ุชุนููู ูุณุจุฉ ุงูุชุฑุงุถูุฉ ุฅุฐุง ูุงูุช ุบูุฑ ููุฌูุฏุฉ
                if ( percent == null || percent === "" )
                {
                    await dbNoUp_PandBill.keySet( rawId.key, "PandBillPercent", "100" );
                }

                // ุชุนููู ุณุนุฑ ุงูุชุฑุงุถู ุฅุฐุง ูุงู ุบูุฑ ููุฌูุฏ
                if ( price == null || price === "" )
                {
                    await dbNoUp_PandBill.keySet(
                        rawId.key,
                        "PandBillPrice",
                        pandPrice
                    );
                }

                // ุชุนููู ููุน ุงูุนูู ุงูุงูุชุฑุงุถู ุฅุฐุง ูุงู ุบูุฑ ููุฌูุฏ
                if ( PandBillKindWork == null || PandBillKindWork === "" )
                {
                    await dbNoUp_PandBill.keySet(
                        rawId.key,
                        "PandBillKindWork",
                        "0"
                    );
                    await isPriceEdit( rawId.key, 0 );
                }
                else
                {
                    if ( PandBillKindWork == "0" )
                    {
                        await isPriceEdit( rawId.key, 0 );
                    } else
                    {
                        await isPriceEdit( rawId.key, 1 );
                    }
                }

                // ุชุนููู ููุน ุงูุชุฌููุน ุงูุงูุชุฑุงุถู ุฅุฐุง ูุงู ุบูุฑ ููุฌูุฏ
                if ( PandBillKindSum == null || PandBillKindSum === "" )
                {
                    await dbNoUp_PandBill.keySet(
                        rawId.key,
                        "PandBillKindSum",
                        "0"
                    );
                }
            }

            //#region ุชุญุฏูุซ ุงูููู ุฏุงุฎู ุนูุงุตุฑ ุงูุตูุญุฉ
            const priceWorks = document.querySelectorAll( '[id="priceWork"]' );
            const states = document.querySelectorAll( '[id="PandBillStat"]' );
            const percents = document.querySelectorAll( '[id="PandBillPercent"]' );
            const prices = document.querySelectorAll( '[id="PandBillPrice"]' );
            const PandBillKindWorks = document.querySelectorAll( '[id="PandBillKindWork"]' );
            const PandBillKindSums = document.querySelectorAll( '[id="PandBillKindSum"]' );

            priceWorks.forEach( ( priceWork ) =>
            {
                priceWork.innerText = pandPrice;
            } );

            states.forEach( ( state ) =>
            {
                if (
                    state.value == null ||
                    state.value === "" ||
                    state.value !== statPrevText
                )
                {
                    state.value = getLang( 685 );
                }
            } );

            percents.forEach( ( percent ) =>
            {
                if ( percent.value == null || percent.value === "" )
                {
                    percent.value = "100";
                }
            } );

            prices.forEach( ( price ) =>
            {
                if ( price.value == null || price.value === "" )
                {
                    price.value = pandPrice;
                }
            } );

            PandBillKindWorks.forEach( ( PandBillKindWork ) =>
            {
                if ( PandBillKindWork.value == null || PandBillKindWork.value === "" )
                {
                    PandBillKindWork.value = "0";
                }
            } );

            PandBillKindSums.forEach( ( PandBillKindSum ) =>
            {
                if ( PandBillKindSum.value == null || PandBillKindSum.value === "" )
                {
                    PandBillKindSum.value = "0";
                }
            } );
            //#endregion

            // ุงุณุชุนุงุฏุฉ ุฌููุน ุงูููู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุฅูู ุงูุตูุญุฉ
            await restoreAllInputsFromIndexDB( "results", dbNoUp_PandBill, 'resultsTable' );
            // ูุฑุงูุจุฉ ุฌููุน ุงูุญููู ูุชุญุฏูุซ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุนูุฏ ุงูุชุบููุฑ
            await watchingAllInputs2IndexDB( "results", dbNoUp_PandBill, 'resultsTable' );

        } catch ( error )
        {
            // ุทุจุงุนุฉ ุงูุฎุทุฃ ูู ูุญุฏุฉ ุงูุชุญูู
            console.error( "๐จ Error in initialValues:", error );
        } finally
        {
            // ุฅุนุงุฏุฉ ุชูุนูู ูุฑุงูุจุฉ ุงูุฌุฏูู
            isTableWatcherEnabled = true;
        }
    }

    /**
     * ุฏุงูุฉ ุชูููู ุฃู ุชุนุทูู ุฅููุงููุฉ ุชุนุฏูู ุญูู ุงูุณุนุฑ ูู ุตู ุงูุฌุฏูู
     * @param {string} tableId ูุนุฑู ุงูุตู ุงูุฃุณุงุณู ูู ุงูุฌุฏูู
     * @param {number} state ุฅุฐุง ูุงูุช ุงููููุฉ 1 ูุฌุนู ุงูุญูู ูุงุจู ููุชุนุฏููุ ุบูุฑ ุฐูู ูุฌุนูู ูููุฑุงุกุฉ ููุท
     */
    async function isPriceEdit ( tableId, state )
    {
        try
        {
            // ุงูุชุญูู ูู ุตุญุฉ ูุนุฑู ุงูุตู
            if ( !isValidIdFormat( tableId ) ) { return; }

            // ุงูุญุตูู ุนูู ุนูุตุฑ ุงูุตู ูู ุงูุตูุญุฉ ุจุงุณุชุฎุฏุงู ุงููุนุฑู
            let rawElement = document.getElementById( tableId + "_" );

            // ุฅุฐุง ูู ูุชู ุงูุนุซูุฑ ุนูู ุงูุนูุตุฑุ ุงูุฎุฑูุฌ ูู ุงูุฏุงูุฉ
            if ( !rawElement ) return;

            // ุงูุจุญุซ ุนู ุนูุตุฑ ุญูู ุงูุณุนุฑ ุฏุงุฎู ุงูุตู
            let priceElement = rawElement.querySelector( "#PandBillPrice" );

            // ุฅุฐุง ูู ูุชู ุงูุนุซูุฑ ุนูู ุญูู ุงูุณุนุฑุ ุงูุฎุฑูุฌ ูู ุงูุฏุงูุฉ
            if ( !priceElement ) return;

            // ุฅุฐุง ูุงูุช ุงูุญุงูุฉ 1ุ ุงุฌุนู ุงูุญูู ูุงุจู ููุชุนุฏูู
            if ( state === 1 )
            {
                priceElement.removeAttribute( "readonly" ); // ุฅุฒุงูุฉ ุฎุงุตูุฉ ุงููุฑุงุกุฉ ููุท
                priceElement.style.border = "1px solid #234890"; // ุฅุถุงูุฉ ุฅุทุงุฑ ุฃุฒุฑู
                priceElement.style.backgroundColor = "#234890"; // ุชุบููุฑ ููู ุงูุฎูููุฉ ููุฃุฒุฑู
                priceElement.style.color = "#fff"; // ุชุบููุฑ ููู ุงูุฎุท ููุฃุจูุถ ููุชูุงุณุจ ูุน ุงูุฎูููุฉ
            } else
            {
                // ุฅุฐุง ูุงูุช ุงูุญุงูุฉ ุบูุฑ 1ุ ุงุฌุนู ุงูุญูู ูููุฑุงุกุฉ ููุท
                priceElement.setAttribute( "readonly", true ); // ุชูุนูู ุฎุงุตูุฉ ุงููุฑุงุกุฉ ููุท
                priceElement.style.border = "none"; // ุฅุฒุงูุฉ ุงูุฅุทุงุฑ
                priceElement.style.backgroundColor = "transparent"; // ุฅุนุงุฏุฉ ุงูุฎูููุฉ ูููุถุน ุงูุงูุชุฑุงุถู
                priceElement.style.color = ""; // ุฅุนุงุฏุฉ ููู ุงูุฎุท ูููุถุน ุงูุงูุชุฑุงุถู
            }
        } catch ( error )
        {
            // ูู ุญุงู ุญุฏูุซ ุฎุทุฃ ุฃุซูุงุก ุงูุชูููุฐุ ุทุจุงุนุชู ูู ูุญุฏุฉ ุงูุชุญูู
            console.error( "Error in isPriceEdit:", error );
        }
    }

</script>
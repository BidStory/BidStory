<!--- Ø²Ø± Ø¥Ø¶Ø§ÙØ© Ø¯ÙØ¹Ø© Ø¬Ø¯ÙŠØ¯Ø© --->
<!-- Ø²Ø± Ù„Ø¥Ø¶Ø§ÙØ© Ø¯ÙØ¹Ø© Ø¬Ø¯ÙŠØ¯Ø©ØŒ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„ÙŠÙ‡ ÙŠØªÙ… Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø¯Ø§Ù„Ø© addBill -->
<button onclick="addBill()">
    <img id="i_addBill" alt="addBill" style="width: 20px; height: 20px; vertical-align: middle; margin-left: 5px" />
    <br />
    <span id="t_1268"></span>
    <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦ØªÙ‡ Ø¨Ù†Øµ Ù…Ø¹Ø±Ù‘Ø¨ -->
</button>
<!-- Ø²Ø± Ù„Ø­Ø°Ù Ø§Ù„Ø¯ÙØ¹Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©ØŒ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„ÙŠÙ‡ ÙŠØªÙ… Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø¯Ø§Ù„Ø© deletBill -->
<button onclick="deletBill()">
    <img id="i_delet" alt="addBill" style="width: 20px; height: 20px; vertical-align: middle; margin-left: 5px" />
    <br />
    <span id="t_214"></span>
    <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦ØªÙ‡ Ø¨Ù†Øµ Ù…Ø¹Ø±Ù‘Ø¨ -->
</button>
<!--- Ø­Ø§ÙˆÙŠØ© Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¯ÙØ¹Ø§Øª --->
<br /><br />
<div id="buttonsContainer"></div>

<br /><br />

<style>
    /* ØªØ®ØµÙŠØµ Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ…Ø±ÙŠØ± Ù„Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø¬Ø¯ÙˆÙ„ */
    #billContaner::-webkit-scrollbar {
        height: 10px;
    }

    #billContaner::-webkit-scrollbar-track {
        background: #f0f0f0;
        border-radius: 5px;
    }

    #billContaner::-webkit-scrollbar-thumb {
        background: linear-gradient(90deg, #3d3e3f, #3d3e3f);
        border-radius: 5px;
    }

    #billContaner::-webkit-scrollbar-thumb:hover {
        background: linear-gradient(90deg, #040404, #040404);
    }
</style>
<!--- Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø¬Ø¯ÙˆÙ„ --->
<div id="billContaner" style="max-width:100%;overflow-x: scroll;"></div>

<!-- Ù‚Ø§Ù„Ø¨ Ø§Ù„ØµÙÙˆÙ Ø§Ù„Ù…Ø®ÙÙŠØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø© Ù„Ù†Ø³Ø® ØµÙÙˆÙ Ø§Ù„Ø¬Ø¯ÙˆÙ„ -->
<div id="PandBillRaw" style="display: none;">
    <table>
        <thead class="hide-text">
            <tr>
                <!-- Ø¹Ù†Ø§ÙˆÙŠÙ† Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© (Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦ØªÙ‡Ø§ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹) -->
                <th id="t_37"></th>
                <th id="t_413"></th>
                <th id="t_112"></th>
                <th id="t_113"></th>
                <th id="t_114"></th>
                <th id="t_115"></th>
                <th id="t_116"></th>
                <th id="t_907"></th>
                <th id="t_93"></th>
                <th id="t_293"></th>
                <th id="t_861"></th>
                <th id="t_281"></th>
                <th id="t_39"></th>
                <th id="t_104"></th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <!-- ÙƒÙ„ Ø¹Ù…ÙˆØ¯ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ input Ø£Ùˆ select Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª -->
                <td>
                    <input id="numbering" readonly type="text" placeholder=""
                        style="outline: none; border: none; background-color: transparent; color: black;" />
                </td>
                <td>
                    <input id="PandBillText" type="text" placeholder=""
                        style="border: none; background-color: transparent; color: black" />
                </td>
                <td>
                    <input id="PandBillNo" type="number" placeholder=""
                        style="border: none; background-color: transparent; color: black" />
                </td>
                <td>
                    <input id="PandBillLength" type="number" placeholder=""
                        style="border: none; background-color: transparent; color: black" />
                </td>
                <td>
                    <input id="PandBillWidth" type="number" placeholder=""
                        style="border: none; background-color: transparent; color: black" />
                </td>
                <td>
                    <input id="PandBillHight" type="number" placeholder=""
                        style="border: none; background-color: transparent; color: black" />
                </td>
                <td>
                    <input id="PandBillKg" type="number" placeholder=""
                        style="border: none; background-color: transparent; color: black" />
                </td>
                <td>
                    <select id="PandBillKindSum">
                        <option id="t_401" value="0"></option>
                        <option id="t_118" value="1"></option>
                    </select>
                </td>
                <td>
                    <input id="PandBillSum" readonly type="number" placeholder=""
                        style="outline: none; border: none; background-color: transparent; color: black;" />
                </td>
                <td>
                    <select id="PandBillStat" disabled>
                        <option id="t_685" value="0"></option>
                        <option id="t_292" value="1"></option>
                    </select>
                </td>
                <td>
                    <select id="PandBillKindWork">
                        <option id="t_226" value="0"></option>
                        <option id="t_227" value="1"></option>
                    </select>
                </td>
                <td>
                    <input id="PandBillPercent" type="number" min="0" max="100" placeholder=""
                        style="outline: none; border: none; background-color: transparent; color: black;" />
                </td>
                <td>
                    <input id="PandBillPrice" readonly type="number" placeholder=""
                        style="outline: none; border: none; background-color: transparent; color: black;" />
                </td>
                <td>
                    <input id="PandBillNote" type="text" placeholder=""
                        style="outline: none; border: none; background-color: transparent; color: black;" />
                </td>
            </tr>
        </tbody>
    </table>
</div>

<!-- Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© -->
<div id="results">
    <br><br>
    <table>
        <!-- ØµÙÙˆÙ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ© Ù„Ù„Ø£Ø¹Ù…Ø§Ù„ ÙˆØ§Ù„ØªØ´ÙˆÙŠÙ†Ø§Øª -->
        <tr>
            <td><label id="t_925"></label></td>
            <td><input id="TotalWorksAddition" type="text" readonly placeholder=""
                    style="outline: none; border: none; background-color: transparent; color: black;" /></td>
        </tr>
        <tr>
            <td><label id="t_926"></label></td>
            <td><input id="TotalWorksDiscount" type="text" readonly placeholder=""
                    style="outline: none; border: none; background-color: transparent; color: black;" /></td>
        </tr>
        <tr>
            <td><label id="t_929"></label></td>
            <td><input id="TotalWorks" type="text" readonly placeholder=""
                    style="outline: none; border: none; background-color: transparent; color: black;" /></td>
        </tr>
        <tr>
            <td><label id="t_927"></label></td>
            <td><input id="TotalSuppliesAddition" type="text" readonly placeholder=""
                    style="outline: none; border: none; background-color: transparent; color: black;" /></td>
        </tr>
        <tr>
            <td><label id="t_928"></label></td>
            <td><input id="TotalSuppliesDiscount" type="text" readonly placeholder=""
                    style="outline: none; border: none; background-color: transparent; color: black;" /></td>
        </tr>
        <tr>
            <td><label id="t_930"></label></td>
            <td><input id="TotalSupplies" type="text" readonly placeholder=""
                    style="outline: none; border: none; background-color: transparent; color: black;" /></td>
        </tr>
    </table>
    <br><br>
    <table>
        <thead>
            <tr style="text-align: center; vertical-align: middle;">
                <!-- Ø¹Ù†Ø§ÙˆÙŠÙ† Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© Ù„Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„ØªÙØµÙŠÙ„ÙŠ -->
                <th id="t_293"></th>
                <th id="t_922"></th>
                <th id="t_39"></th>
                <th id="t_40"></th>
            </tr>
        </thead>
        <!-- ØµÙÙˆÙ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ© Ù„Ù„Ø£Ø¹Ù…Ø§Ù„ ÙˆØ§Ù„ØªØ´ÙˆÙŠÙ†Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© ÙˆØ§Ù„Ø­Ø§Ù„ÙŠØ© -->
        <tr style="text-align: center; vertical-align: middle;">
            <td><label id="t_321"></label></td>
            <td>
                <input id="PreviousWorksValue" type="text" readonly placeholder=""
                    style="outline: none; border: none; background-color: transparent; color: black; max-width: 50px; min-width:  50px;" />
                <input id="PreviousWorksPercent" type="text" readonly placeholder=""
                    style="outline: none; border: none; background-color: transparent; color: black; max-width: 50px; min-width:  50px;" />
            </td>
            <td><label id="priceWork"></label></td>
            <td>
                <input id="PreviousWorksTotalCost" type="text" readonly placeholder=""
                    style="outline: none; border: none; background-color: transparent; color: black; max-width: 50px; min-width:  50px;" />
            </td>
        </tr>
        <tr style="text-align: center; vertical-align: middle;">
            <td><label id="t_320"></label></td>
            <td>
                <input id="CurrentWorksValue" type="number" placeholder=""
                    style="border: 1px solid black; background-color: transparent; color: black; max-width: 50px; min-width:  50px;" />
                <input id="CurrentWorksPercent" type="number" placeholder=""
                    style="border: 1px solid black; background-color: transparent; color: black; max-width: 50px; min-width:  50px;" />
            </td>
            <td><label id="priceWork"></label></td>
            <td>
                <input id="CurrentWorksTotalCost" type="text" readonly placeholder=""
                    style="outline: none; border: none; background-color: transparent; color: black; max-width: 50px; min-width:  50px;" />
            </td>
        </tr>
        <tr style="text-align: center; vertical-align: middle;">
            <td><label id="t_323"></label></td>
            <td>

                <input id="TotalExecutedWorksValue" type="text" readonly placeholder="" style="  max-width: 50px; min-width:  50px; outline: none; border: none; background-color:
                    transparent; color: black;" />
                <input id="TotalExecutedWorksPercent" type="text" readonly placeholder="" style=" max-width: 50px; min-width:  50px; outline: none; border: none; background-color:
                    transparent; color: black;" />

            </td>
            <td><label id="priceWork"></label></td>
            <td>
                <input id="TotalExecutedWorksTotalCost" type="text" readonly placeholder=""
                    style="outline: none; border: none; background-color: transparent; color: black; max-width: 50px; min-width:  50px;" />

            </td>
        </tr>
        <tr style="text-align: center; vertical-align: middle;">
            <td><label id="t_920"></label></td>
            <td>
                <input id="PreviousSuppliesValue" type="text" readonly placeholder=""
                    style="outline: none; border: none; background-color: transparent; color: black; max-width: 50px; min-width:  50px;" />
                <input id="PreviousSuppliesPercent" type="text" readonly placeholder=""
                    style="outline: none; border: none; background-color: transparent; color: black; max-width: 50px; min-width:  50px;" />

            </td>
            <td>
                <input id="PreviousSuppliesPrice" type="text" readonly placeholder=""
                    style="outline: none; border: none; background-color: transparent; color: black; max-width: 50px; min-width:  50px;" />

            </td>
            <td>
                <input id="PreviousSuppliesTotalCost" type="text" readonly placeholder=""
                    style="outline: none; border: none; background-color: transparent; color: black; max-width: 50px; min-width:  50px;" />

            </td>
        </tr>
        <tr style="text-align: center; vertical-align: middle;">
            <td><label id="t_919"></label></td>
            <td>
                <input id="CurrentSuppliesValue" type="number" placeholder=""
                    style=" border: 1px solid black; background-color: transparent; color: black; max-width: 50px; min-width:  50px;" />
                <input id="CurrentSuppliesPercent" type="number" placeholder=""
                    style=" border: 1px solid black; background-color: transparent; color: black; max-width: 50px; min-width:  50px;" />
            </td>
            <td>
                <input id="CurrentSuppliesPrice" type="text" readonly placeholder=""
                    style="outline: none; border: none; background-color: transparent; color: black; max-width: 50px; min-width:  50px;" />
            </td>
            <td>
                <input id="CurrentSuppliesTotalCost" type="text" readonly placeholder=""
                    style="outline: none; border: none; background-color: transparent; color: black; max-width: 50px; min-width:  50px;" />
            </td>
        </tr>
        <tr style="text-align: center; vertical-align: middle;">
            <td><label id="t_921"></label></td>
            <td>
                <input id="TotalExecutedSuppliesValue" type="text" readonly placeholder=""
                    style="outline: none; border: none; background-color: transparent; color: black; max-width: 50px; min-width:  50px;" />
                <input id="TotalExecutedSuppliesPercent" type="text" readonly placeholder=""
                    style="outline: none; border: none; background-color: transparent; color: black; max-width: 50px; min-width:  50px;" />

            </td>
            <td>
                <input id="TotalExecutedSuppliesPrice" type="text" readonly placeholder=""
                    style="outline: none; border: none; background-color: transparent; color: black; max-width: 50px; min-width:  50px;" />

            </td>
            <td>
                <input id="TotalExecutedSuppliesTotalCost" type="text" readonly placeholder=""
                    style="outline: none; border: none; background-color: transparent; color: black; max-width: 50px; min-width:  50px;" />

            </td>
        </tr>
    </table>
</div>
<script>
    let worksOverPercent = null;
    let suppliesOverPercent = null;
    let stop_changes = false;
    // Ø¯Ø§Ù„Ø© ØªÙ†ÙØ° Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø£ÙŠ Ù…Ù† Ø§Ù„Ø­Ù‚ÙˆÙ„
    function handleSuppliesValueChange ()
    {
        const value = document.getElementById( "CurrentSuppliesValue" ).value;
        const percent = document.getElementById( "CurrentSuppliesPercent" ).value;

        console.log( "ğŸ”„ ØªÙ… Ø§Ù„ØªØºÙŠÙŠØ±:" );
        console.log( "âœ… Ø§Ù„ÙƒÙ…ÙŠØ©:", value );
        console.log( "âœ… Ø§Ù„Ù†Ø³Ø¨Ø©:", percent );

        // ÙŠÙ…ÙƒÙ†Ùƒ Ù‡Ù†Ø§ Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø£ÙŠ Ø¯Ø§Ù„Ø© Ø£Ø®Ø±Ù‰ Ø¨Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø£Ùˆ Ø§Ù„ØªØ­Ù‚Ù‚
        // calculateSuppliesPercentprice([...], [...], [...]);
    }

    function handleWorksValueChange ()
    {
        if ( stop_changes == true ) { return; }
        stop_changes = true;
        const value = document.getElementById( "CurrentWorksValue" ).value;
        document.getElementById( "CurrentWorksPercent" ).value = worksOverPercent / value;
        stop_changes = false;
    }
    function handleWorksPercentChange ()
    {
        if ( stop_changes == true ) { return; }
        stop_changes = true;
        const percent = document.getElementById( "CurrentWorksPercent" ).value;
        document.getElementById( "CurrentWorksValue" ).value = worksOverPercent / percent;
        stop_changes = false;
    }
    // Ø±Ø¨Ø· Ø§Ù„Ø­Ø¯Ø«ÙŠÙ†
    document.getElementById( "CurrentSuppliesValue" ).addEventListener( "input", handleSuppliesValueChange );
    document.getElementById( "CurrentSuppliesPercent" ).addEventListener( "input", handleSuppliesPercentChange );
    document.getElementById( "CurrentWorksValue" ).addEventListener( "input", handleWorksValueChange );
    document.getElementById( "CurrentWorksPercent" ).addEventListener( "input", handleWorksPercentChange );

</script>

<script>

    // ğŸŸ¡ ØªØ¹Ø±ÙŠÙ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© - ØªÙ… Ù†Ù‚Ù„Ù‡Ø§ Ø¥Ù„Ù‰ Ù…Ù„Ù Ø§Ù„Ø£Ø¯ÙˆØ§Øª

    /**
     * Ø¯Ø§Ù„Ø© Ù„Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¯ÙØ¹Ø§Øª Ù…Ù† Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© ÙˆØ¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ù…Ø¤Ø´Ø±Ø§Øª
     */
    function clearAllButtons ()
    {
        // ØªÙØ±ÙŠØº Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ù…Ù† Ø§Ù„Ø£Ø²Ø±Ø§Ø±
        document.getElementById( "buttonsContainer" ).innerHTML = "";
        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ù…Ø¤Ø´Ø±Ø§Øª (Ù„Ù…Ù†Ø¹ ØªÙƒØ±Ø§Ø± Ø§Ù„Ø£Ø²Ø±Ø§Ø±)
        buttonShowIndexSet.clear();
    }

    /**
     * Ø¯Ø§Ù„Ø© Ø¥Ø¶Ø§ÙØ© Ø¯ÙØ¹Ø© Ø¬Ø¯ÙŠØ¯Ø© Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± "Ø¥Ø¶Ø§ÙØ© Ø­ØµØ±"
     * ØªÙ‚ÙˆÙ… Ø¨ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØµÙØ­Ø© Ø«Ù… Ø¥Ø¶Ø§ÙØ© Ø²Ø± Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ø¯ÙØ¹Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©
     */
    async function addBill ()
    {
        try
        {
            // ØªÙ‡ÙŠØ¦Ø© ØµÙØ­Ø© Ø§Ù„Ø­ØµØ± (ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©)
            await initPandBillPage();
            // Ø²ÙŠØ§Ø¯Ø© Ø±Ù‚Ù… Ø¢Ø®Ø± Ø¯ÙØ¹Ø©
            lastBill += 1;
            // Ø¥Ø¶Ø§ÙØ© Ø²Ø± Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ø¯ÙØ¹Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©
            await addButton( lastBill );
        } catch ( error )
        {
            // Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ø®Ø·Ø£ ÙÙŠ ÙˆØ­Ø¯Ø© Ø§Ù„ØªØ­ÙƒÙ…
            console.error( "âŒ Ø®Ø·Ø£ ÙÙŠ addBill:", error );
        }
    }

    /**
     * Ø¯Ø§Ù„Ø© Ø­Ø°Ù Ø§Ù„Ø¯ÙØ¹Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„Ø­Ø°Ù
     * ØªÙ‚ÙˆÙ… Ø¨Ø­Ø°Ù Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø®Ø§ØµØ© Ø¨Ø§Ù„Ø¯ÙØ¹Ø© Ø§Ù„Ø£Ø®ÙŠØ±Ø© ÙˆØªÙØ±ÙŠØº Ø§Ù„Ø­Ø§ÙˆÙŠØ©
     */
    async function deletBill ()
    {
        try
        {
            // Ø­Ø°Ù Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯ÙØ¹Ø© Ø§Ù„Ø£Ø®ÙŠØ±Ø©
            await deleteDatabase( "bill_" + lastBill + "_" + selectedPandId );
            // Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
            clearAllButtons();
            // Ø¥Ø¹Ø§Ø¯Ø© ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØµÙØ­Ø©
            await initPandBillPage();
            // ØªÙØ±ÙŠØº Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø¬Ø¯ÙˆÙ„
            document.getElementById( "billContaner" ).innerHTML = "";
        } catch ( error )
        {
            // Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ø®Ø·Ø£ ÙÙŠ ÙˆØ­Ø¯Ø© Ø§Ù„ØªØ­ÙƒÙ…
            console.error( "âŒ Ø®Ø·Ø£ ÙÙŠ deletBill:", error );
        }
    }

    /**
     * Ø¯Ø§Ù„Ø© ØªØ­Ù…ÙŠÙ„ Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© ÙˆØ¥Ø¸Ù‡Ø§Ø± Ø£Ø²Ø±Ø§Ø±Ù‡Ø§
     * ØªÙ‚ÙˆÙ… Ø¨Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø­ØªÙ‰ 100 Ø¯ÙØ¹Ø© ÙˆØªØ¶ÙŠÙ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù…Ù‚Ø§Ø¨Ù„Ø© Ù„Ù‡Ø§
     */
    async function initPandBillPage ()
    {
        try
        {
            lastBill = 0;
            let i = 1;
            // Ø­Ù„Ù‚Ø© Ù„Ù„Ø¨Ø­Ø« Ø¹Ù† Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø­ØªÙ‰ 100 Ø¯ÙØ¹Ø© ÙƒØ­Ø¯ Ø£Ù‚ØµÙ‰
            while ( i <= 1000 )
            {
                // Ø§Ø³Ù… Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                const dbName = "bill_" + i + "_" + selectedPandId;
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                const exists = await checkDatabaseExists( dbName );
                if ( exists )
                {
                    // Ø¥Ø¶Ø§ÙØ© Ø²Ø± Ù„Ù„Ø¯ÙØ¹Ø©
                    await addButton( i );
                    // ØªØ­Ø¯ÙŠØ« Ø±Ù‚Ù… Ø¢Ø®Ø± Ø¯ÙØ¹Ø©
                    lastBill = i;
                    i++;
                } else
                {
                    // Ø§Ù„ØªÙˆÙ‚Ù Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…ÙˆØ¬ÙˆØ¯Ø©
                    break;
                }
            }
        } catch ( error )
        {
            // Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ø®Ø·Ø£ ÙÙŠ ÙˆØ­Ø¯Ø© Ø§Ù„ØªØ­ÙƒÙ…
            console.error( "âŒ Ø®Ø·Ø£ ÙÙŠ initPandBillPage:", error );
        }
    }

    /**
     * Ø¯Ø§Ù„Ø© Ø¥Ù†Ø´Ø§Ø¡ Ø²Ø± Ø¬Ø¯ÙŠØ¯ ÙŠÙ…Ø«Ù„ Ø¯ÙØ¹Ø© Ù…Ø¹ÙŠÙ†Ø©
     * @param {number} billIndex Ø±Ù‚Ù… Ø§Ù„Ø¯ÙØ¹Ø©
     */
    async function addButton ( billIndex )
    {
        try
        {
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ø¯Ù… ØªÙƒØ±Ø§Ø± Ø§Ù„Ø²Ø±
            if ( buttonShowIndexSet.has( billIndex ) )
            {
                return;
            } else
            {
                // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø¤Ø´Ø± ÙÙŠ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©
                buttonShowIndexSet.add( billIndex );
            }

            // Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù†ØµØ± Ø§Ù„Ø²Ø±
            const button = document.createElement( "button" );
            button.id = "BillB_" + billIndex;
            // Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø± ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯ÙØ¹Ø©
            button.onclick = async function ()
            {
                await addPandBillDatabase( billIndex );
            };
            button.style.margin = "5px";

            // Ø¥Ø¶Ø§ÙØ© ØµÙˆØ±Ø© Ù„Ù„Ø²Ø±
            const img = document.createElement( "img" );
            img.alt = "Bill";
            img.id = "i_bill";
            img.style.width = "20px";
            img.style.height = "20px";
            img.style.verticalAlign = "middle";
            img.style.marginLeft = "5px";

            button.appendChild( img );
            button.appendChild( document.createElement( "br" ) );

            // Ø¥Ø¶Ø§ÙØ© Ù†Øµ Ù…Ø¹Ø±Ù Ø§Ù„Ø²Ø±
            const span = document.createElement( "span" );
            span.id = "t_1065_" + billIndex;
            button.appendChild( span );

            // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø²Ø± Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙˆÙŠØ©
            document.getElementById( "buttonsContainer" ).appendChild( button );

            // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØ±Ø¬Ù…Ø© ÙˆØ§Ù„ØµÙˆØ±
            await setTextAndImage();

            // Ø¥Ø¶Ø§ÙØ© Ø±Ù‚Ù… Ø§Ù„Ø¯ÙØ¹Ø© Ø¨Ø¬Ø§Ù†Ø¨ Ø§Ù„Ø²Ø±
            const spanNum = document.createElement( "span" );
            spanNum.innerText = " " + billIndex;
            button.appendChild( spanNum );

        } catch ( error )
        {
            // Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ø®Ø·Ø£ ÙÙŠ ÙˆØ­Ø¯Ø© Ø§Ù„ØªØ­ÙƒÙ…
            console.error( "âŒ Ø®Ø·Ø£ ÙÙŠ addButton:", error );
        }
    }

    // Ù…ØªØºÙŠØ± Ù„Ù…Ù†Ø¹ ØªÙƒØ±Ø§Ø± ØªÙ†ÙÙŠØ° Ø¯Ø§Ù„Ø© addPandBillDatabase ÙÙŠ Ù†ÙØ³ Ø§Ù„ÙˆÙ‚Øª
    let stopAddPandBillDatabase = false;

    /**
     * Ø¯Ø§Ù„Ø© Ø¥Ù†Ø´Ø§Ø¡ Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ¬Ø¯ÙˆÙ„ Ù„Ø¯ÙØ¹Ø© Ù…Ø¹ÙŠÙ†Ø©
     * ÙŠØªÙ… Ø§Ù„ØªÙ†ÙÙŠØ° Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø£Ø­Ø¯ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø®Ø§ØµØ© Ø¨Ø¯ÙØ¹Ø© Ù…Ø¹ÙŠÙ†Ø©
     * @param {number} dataBaseIndex Ø±Ù‚Ù… Ø§Ù„Ø¯ÙØ¹Ø©
     */
    async function addPandBillDatabase ( dataBaseIndex )
    {
        try
        {
            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ù…Ø¹Ø±Ù Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
            dataBaseIdForPandBillPrevious = null;
            // Ù…Ù†Ø¹ ØªÙƒØ±Ø§Ø± Ø§Ù„ØªÙ†ÙÙŠØ°
            if ( stopAddPandBillDatabase == true ) { return; }
            stopAddPandBillDatabase = true;
            // ØªØ¹Ø·ÙŠÙ„ Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ù…Ø¤Ù‚ØªØ§Ù‹
            isTableWatcherEnabled = false;
            // ØªØ¹ÙŠÙŠÙ† Ø§Ø³Ù… Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©
            dataBaseIdForPandBill = "bill_" + dataBaseIndex + "_" + selectedPandId;

            // Ù…Ø­Ø§ÙˆÙ„Ø© Ø­Ø°Ù Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø³Ø§Ø¨Ù‚ (Ø¥Ù† ÙˆÙØ¬Ø¯)
            try
            {
                await PandBillTable.destroyTable();
            } catch ( error )
            {
                // ØªØ¬Ø§Ù‡Ù„ Ø§Ù„Ø®Ø·Ø£ Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù‡Ù†Ø§Ùƒ Ø¬Ø¯ÙˆÙ„ Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹
            }
            let newBillAndGreaThan1 = false;
            // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø±Ù‚Ù… Ø§Ù„Ø¯ÙØ¹Ø© Ø£ÙƒØ¨Ø± Ù…Ù† 1ØŒ ØªØ¹ÙŠÙŠÙ† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
            if ( Number( dataBaseIndex ) > 1 )
            {
                dataBaseIdForPandBillPrevious = "bill_" + ( Number( dataBaseIndex ) - 1 ) + "_" + selectedPandId;
                //ØªØµØ¯ÙŠØ± Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
                if ( await checkDatabaseExists( dataBaseIdForPandBill ) == false )
                {
                    const backup = await exportEntireDatabase( dataBaseIdForPandBillPrevious );
                    backup.database = dataBaseIdForPandBill;
                    backup.stores.forEach( store =>
                    {
                        store.data.forEach( item =>
                        {
                            if ( item.key === "PandBillStat" )
                            {
                                item.value = "1";
                            }
                        } );
                    } );
                    await importOrUpdateFromJSON( backup );
                    newBillAndGreaThan1 = true;
                }
            }
            // Ø¥Ù†Ø´Ø§Ø¡ ÙƒØ§Ø¦Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø¯ÙˆÙ† ØªØ±Ù‚ÙŠØ©
            dbNoUp_PandBill = await new noUpgrade( dataBaseIdForPandBill );
            if ( Number( dataBaseIndex ) > 1 )
            {
                dbNoUp_PandBillPrevious = await new noUpgrade( dataBaseIdForPandBillPrevious );
            }
            // Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ù…ÙˆØ¬ÙˆØ¯Ø§Ù‹ØŒ ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡
            if ( await dbNoUp_PandBill.isTableExist( "resultsTable" ) == false )
            {
                let dbUp_PandBill = await new upgrade( dataBaseIdForPandBill );
                await dbUp_PandBill.createKeyTable( "resultsTable" );

                dbNoUp_PandBill = await new noUpgrade( dataBaseIdForPandBill );
                if ( Number( dataBaseIndex ) > 1 )
                {
                    dbNoUp_PandBillPrevious = await new noUpgrade( dataBaseIdForPandBillPrevious );
                }
            }
            //#region Ø§Ø¶Ø§ÙÙ‡ Ø§Ù„Ø§Ø¹Ù…Ø§Ù„ Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
            if ( newBillAndGreaThan1 == true )
            {
                let TotalExecutedWorksValue = await dbNoUp_PandBill.keyGet( 'resultsTable', "TotalExecutedWorksValue" );
                let TotalExecutedWorksPercent = await dbNoUp_PandBill.keyGet( 'resultsTable', "TotalExecutedWorksPercent" );
                let TotalExecutedWorksTotalCost = await dbNoUp_PandBill.keyGet( 'resultsTable', "TotalExecutedWorksTotalCost" );
                await dbNoUp_PandBill.keySet( 'resultsTable', "PreviousWorksValue", TotalExecutedWorksValue );
                await dbNoUp_PandBill.keySet( 'resultsTable', "PreviousWorksPercent", TotalExecutedWorksPercent );
                await dbNoUp_PandBill.keySet( 'resultsTable', "PreviousWorksTotalCost", TotalExecutedWorksTotalCost );
                await dbNoUp_PandBill.keySet( 'resultsTable', "CurrentWorksValue", "" );
                await dbNoUp_PandBill.keySet( 'resultsTable', "CurrentWorksPercent", "" );
                await dbNoUp_PandBill.keySet( 'resultsTable', "CurrentWorksTotalCost", "" );
                //Ø¨Ø§Ù„Ù†Ø³Ø¨Ø© Ù„Ù„ØªØ´ÙˆÙŠÙ†Ø§Øª
                let TotalExecutedSuppliesValue = await dbNoUp_PandBill.keyGet( 'resultsTable', "TotalExecutedSuppliesValue" );
                let TotalExecutedSuppliesPercent = await dbNoUp_PandBill.keyGet( 'resultsTable', "TotalExecutedSuppliesPercent" );
                let TotalExecutedSuppliesPrice = await dbNoUp_PandBill.keyGet( 'resultsTable', "TotalExecutedSuppliesPrice" );
                let TotalExecutedSuppliesTotalCost = await dbNoUp_PandBill.keyGet( 'resultsTable', "TotalExecutedSuppliesTotalCost" );
                await dbNoUp_PandBill.keySet( 'resultsTable', "PreviousSuppliesValue", TotalExecutedSuppliesValue );
                await dbNoUp_PandBill.keySet( 'resultsTable', "PreviousSuppliesPercent", TotalExecutedSuppliesPercent );
                await dbNoUp_PandBill.keySet( 'resultsTable', "PreviousSuppliesPrice", TotalExecutedSuppliesPrice );
                await dbNoUp_PandBill.keySet( 'resultsTable', "PreviousSuppliesTotalCost", TotalExecutedSuppliesTotalCost );
                await dbNoUp_PandBill.keySet( 'resultsTable', "CurrentSuppliesValue", "" );
                await dbNoUp_PandBill.keySet( 'resultsTable', "CurrentSuppliesPercent", "" );
                await dbNoUp_PandBill.keySet( 'resultsTable', "CurrentSuppliesPrice", "" );
                await dbNoUp_PandBill.keySet( 'resultsTable', "CurrentSuppliesTotalCost", "" );

            }
            //#endregion

            // Ø¥Ù†Ø´Ø§Ø¡ ÙƒØ§Ø¦Ù† Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ø¬Ø¯ÙˆÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
            PandBillTable = new setTableParameter(
                "billContaner", // Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø¬Ø¯ÙˆÙ„
                dataBaseIdForPandBill, // Ø§Ø³Ù… Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                "PandBillRaw", // Ù‚Ø§Ù„Ø¨ Ø§Ù„ØµÙÙˆÙ
                "", // ØµÙ Ø¨Ø¯ÙŠÙ„ (ØºÙŠØ± Ù…Ø³ØªØ®Ø¯Ù… Ø­Ø§Ù„ÙŠØ§Ù‹)
                true, // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¹Ù†ÙˆØ§Ù†
                false, // Ø¹Ø¯Ù… Ø¥Ø¶Ø§ÙØ© ØµÙ Ø¨Ø§Ù„Ù†Ù‚Ø±
                true, // Ø¨Ø¯Ø¡ Ø¨ØµÙ Ø¬Ø¯ÙŠØ¯
                true, // ØªØ±Ù‚ÙŠÙ… Ø§Ù„ØµÙÙˆÙ
                true//Ø¹Ù†Ø§ØµØ± Ø§Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø±Ù‚Ø§Ù… ØªØ¬ØªÙˆÙŠ Ø¹Ù„ÙŠ Ø¬Ø¯Ø§ÙˆÙ„
            );

            // ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© ÙˆØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ù…Ø®Ø²Ù†Ø©
            await initialValues();

        } catch ( error )
        {
            // Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ø®Ø·Ø£ ÙÙŠ ÙˆØ­Ø¯Ø© Ø§Ù„ØªØ­ÙƒÙ…
            console.error( "âŒ Ø®Ø·Ø£ ÙÙŠ addPandBillDatabase:", error );
        } finally
        {
            // Ø¥Ø¹Ø§Ø¯Ø© ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªÙ†ÙÙŠØ° ÙˆÙ…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø¬Ø¯ÙˆÙ„
            stopAddPandBillDatabase = false;
            isTableWatcherEnabled = true;
        }
    }

    /**
     * Ø¯Ø§Ù„Ø© Ù„Ù„ØªØ­Ù‚Ù‚ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ Ù‚ÙŠÙ…Ø© Ø±Ù‚Ù…ÙŠØ© ÙÙŠ Ù…ØµÙÙˆÙØ©
     * @param {Array} array Ù…ØµÙÙˆÙØ© Ø§Ù„Ù‚ÙŠÙ…
     * @returns {boolean} Ù‡Ù„ ÙŠÙˆØ¬Ø¯ Ù‚ÙŠÙ…Ø© Ø±Ù‚Ù…ÙŠØ© Ø£Ù… Ù„Ø§
     */
    function hasNumericValue ( array )
    {
        return array.some( isNumeric );
    }

    // Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„ØªÙŠ ØªØ¯Ø®Ù„ ÙÙŠ Ø­Ø³Ø§Ø¨ Ø­Ø§ØµÙ„ Ø§Ù„Ø¶Ø±Ø¨
    let sumList = [
        "PandBillNo",
        "PandBillLength",
        "PandBillWidth",
        "PandBillHight",
        "PandBillKg"
    ];
    // Ù…ØªØºÙŠØ± Ù„Ù…Ù†Ø¹ ØªÙƒØ±Ø§Ø± ØªÙ†ÙÙŠØ° Ø¯Ø§Ù„Ø© calSumBillSection
    let isCalSumBillSectionRunning = false;

    /**
     * Ø¯Ø§Ù„Ø© Ù„Ø­Ø³Ø§Ø¨ Ø­Ø§ØµÙ„ Ø¶Ø±Ø¨ Ø§Ù„Ù‚ÙŠÙ… ÙÙŠ ØµÙ Ù…Ø¹ÙŠÙ† ÙˆØªØ­Ø¯ÙŠØ« Ø­Ù‚Ù„ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹
     * @param {string} dataName Ø§Ø³Ù… Ø§Ù„Ø­Ù‚Ù„ (ØºÙŠØ± Ù…Ø³ØªØ®Ø¯Ù… Ù‡Ù†Ø§)
     * @param {string} tableId Ù…Ø¹Ø±Ù Ø§Ù„ØµÙ
     */
    async function calSumBillSection ( dataName, tableId )
    {
        try
        {
            // Ù…Ù†Ø¹ ØªÙƒØ±Ø§Ø± Ø§Ù„ØªÙ†ÙÙŠØ°
            if ( isCalSumBillSectionRunning )
            {
                return;
            }

            isCalSumBillSectionRunning = true;
            isTableWatcherEnabled = false;

            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ù…Ø¹Ø±Ù Ø§Ù„ØµÙ
            if ( isValidIdFormat( tableId ) )
            {
                let value = [];
                let valueCheck = [];
                let key = null;
                // Ø¬Ù„Ø¨ Ø§Ù„Ù‚ÙŠÙ… Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                for ( let i = 0; i < sumList.length; i++ )
                {
                    key = sumList[ i ];
                    const valueÙ€Ù€ = await dbNoUp_PandBill.keyGet( tableId, key );
                    valueCheck.push( valueÙ€Ù€ );
                }
                let product = 1;
                // Ø¥Ø°Ø§ Ù„Ù… ØªÙˆØ¬Ø¯ Ø£ÙŠ Ù‚ÙŠÙ…Ø© Ø±Ù‚Ù…ÙŠØ©ØŒ Ø§Ù„Ù†Ø§ØªØ¬ ØµÙØ±
                if ( !hasNumericValue( valueCheck ) )
                {
                    product = 0;
                }
                else
                {
                    // ØªØ¹ÙˆÙŠØ¶ Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„ÙØ§Ø±ØºØ© Ø¨Ù€ 1
                    for ( let i = 0; i < sumList.length; i++ )
                    {
                        let val = valueCheck[ i ];
                        if ( val == null || val === "" )
                        {
                            val = 1;
                        }
                        value[ i ] = val;
                    }
                    // Ø­Ø³Ø§Ø¨ Ø­Ø§ØµÙ„ Ø§Ù„Ø¶Ø±Ø¨
                    for ( let i = 0; i < value.length; i++ )
                    {
                        product *= Number( value[ i ] );
                    }
                    // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù†ÙˆØ¹ Ø§Ù„ØªØ¬Ù…ÙŠØ¹ Ø®ØµÙ…ØŒ Ø§Ø¶Ø±Ø¨ ÙÙŠ -1
                    if ( await dbNoUp_PandBill.keyGet( tableId, 'PandBillKindSum' ) == '1' )
                    {
                        product *= -1;
                    }
                }
                // ØªØ­Ø¯ÙŠØ¯ Ø­Ø§Ù„Ø© Ø¹Ù†ØµØ± Ø§Ù„Ø³Ø¹Ø± Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‚Ø§Ø¨Ù„ Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ Ø£Ù… Ù„Ø§
                if ( await dbNoUp_PandBill.keyGet( tableId, 'PandBillKindWork' ) == '0' )
                {
                    await isPriceEdit( tableId, 0 );
                }
                else
                {
                    await isPriceEdit( tableId, 1 );
                }
                // ØªØ­Ø¯ÙŠØ« Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„Ø¹Ù†ØµØ±
                await dbNoUp_PandBill.keySet( tableId, "PandBillSum", product );
                const raw_ = document.getElementById( tableId + "_" );
                const tot_ = raw_.querySelector( "#PandBillSum" );
                tot_.value = product;
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¬Ø§Ù…ÙŠØ¹ Ø§Ù„ÙƒÙ„ÙŠØ©
                await calSumBill0( dbNoUp_PandBill );
            }

            isTableWatcherEnabled = true;
        } catch ( error )
        {
            // Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ø®Ø·Ø£ ÙÙŠ ÙˆØ­Ø¯Ø© Ø§Ù„ØªØ­ÙƒÙ…
            console.error( "Error calculating calSumBillSection:", error );
        } finally
        {
            isCalSumBillSectionRunning = false;
            isTableWatcherEnabled = true;
        }
    }

    // Ù…ØªØºÙŠØ± Ù„Ù…Ù†Ø¹ ØªÙƒØ±Ø§Ø± ØªÙ†ÙÙŠØ° Ø¯Ø§Ù„Ø© calSumBill0
    let isCalScalSumBill0Running = false;

    /**
     * Ø¯Ø§Ù„Ø© Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø¬Ø§Ù…ÙŠØ¹ Ø§Ù„ÙƒÙ„ÙŠØ© Ù„Ù„Ø£Ø¹Ù…Ø§Ù„ ÙˆØ§Ù„ØªØ´ÙˆÙŠÙ†Ø§Øª ÙˆØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ÙÙŠ Ø§Ù„ØµÙØ­Ø©
     * @param {object} dbNoUp_PandBill ÙƒØ§Ø¦Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
     */
    async function calSumBill0 ( dbNoUp_PandBill )
    {
        try
        {

            //#region Ù…Ù†Ø¹ ØªÙƒØ±Ø§Ø± Ø§Ù„ØªÙ†ÙÙŠØ°
            if ( isCalScalSumBill0Running )
            {
                return;
            }
            isCalScalSumBill0Running = true;
            //#endregion

            //#region Ø¬Ù„Ø¨ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙÙˆÙ Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            let allRows = await dbNoUp_PandBill.getAllDataFromTable( "rows" );
            if ( !Array.isArray( allRows ) )
            {
                return;
            }
            //#endregion

            //#region ØªØ¹Ø±ÙŠÙ Ù…ØµÙÙˆÙØ§Øª Ù„ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ù‚ÙŠÙ… Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹
            let sumCurrentWorksValue = [];
            let sumCurrentWorksPercent = [];
            let sumTotalWorksAddition = [];
            let sumTotalWorksDiscount = [];

            let sumCurrentSuppliesValue = [];
            let sumCurrentSuppliesPercent = [];
            let sumCurrentSuppliesPrices = [];
            let sumTotalSuppliesAddition = [];
            let sumTotalSuppliesDiscount = [];
            //#endregion

            //#region Ø§Ù„Ù…Ø±ÙˆØ± Ø¹Ù„Ù‰ ÙƒÙ„ ØµÙ ÙˆØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ù‚ÙŠÙ… Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹ ÙˆØ§Ù„Ø­Ø§Ù„Ø©
            for ( const rawId of allRows )
            {
                // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù…Ù„ "ØªÙ†ÙÙŠØ°ÙŠ"
                if ( await dbNoUp_PandBill.keyGet( rawId.key, "PandBillKindWork" ) == "0" )
                {

                    sumCurrentWorksValue.push( await dbNoUp_PandBill.keyGet( rawId.key, "PandBillSum" ) );
                    sumCurrentWorksPercent.push( await dbNoUp_PandBill.keyGet( rawId.key, "PandBillPercent" ) );
                    // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù†ÙˆØ¹ Ø§Ù„ØªØ¬Ù…ÙŠØ¹ "Ø¥Ø¶Ø§ÙØ©"
                    if ( await dbNoUp_PandBill.keyGet( rawId.key, "PandBillKindSum" ) == "0" )
                    {
                        sumTotalWorksAddition.push( await dbNoUp_PandBill.keyGet( rawId.key, "PandBillSum" ) );
                    }
                    else
                    {
                        sumTotalWorksDiscount.push( await dbNoUp_PandBill.keyGet( rawId.key, "PandBillSum" ) );
                    }

                }
                // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù…Ù„ "ØªØ´ÙˆÙŠÙ†Ø§Øª"
                else
                {
                    let PandBillSum = await dbNoUp_PandBill.keyGet( rawId.key, "PandBillSum" );
                    sumCurrentSuppliesValue.push( PandBillSum );
                    sumCurrentSuppliesPercent.push( await dbNoUp_PandBill.keyGet( rawId.key, "PandBillPercent" ) );
                    sumCurrentSuppliesPrices.push( await dbNoUp_PandBill.keyGet( rawId.key, "PandBillPrice" ) );

                    // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù†ÙˆØ¹ Ø§Ù„ØªØ¬Ù…ÙŠØ¹ "Ø¥Ø¶Ø§ÙØ©"
                    if ( await dbNoUp_PandBill.keyGet( rawId.key, "PandBillKindSum" ) == "0" )
                    {
                        sumTotalSuppliesAddition.push( PandBillSum );
                    }
                    else
                    {
                        sumTotalSuppliesDiscount.push( PandBillSum );
                    }

                }
            }
            //#endregion

            //#region Ø­Ø³Ø§Ø¨ Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„ÙƒÙ„ÙŠØ© ÙˆØ§Ù„Ù†Ø³Ø¨ Ø§Ù„ÙƒÙ„ÙŠØ© Ù„Ù„Ø£Ø¹Ù…Ø§Ù„ ÙˆØ§Ù„ØªØ´ÙˆÙŠÙ†Ø§Øª
            //Ù…Ø¬Ù…ÙˆØ¹ Ù‚ÙŠÙ… Ø§Ù„Ø§Ø¹Ù…Ø§Ù„ Ø³ÙˆØ§Ø¡ Ø§Ø¶Ø§ÙØ© Ø§Ùˆ Ø®ØµÙ…
            let sumTotalWorksAddationAndSubtract = sumCurrentWorksValue.reduce( ( acc, val ) => acc + val, 0 );
            //Ù…Ø¬Ù…ÙˆØ¹ Ù‚ÙŠÙ… Ø§Ù„ØªØ´ÙˆÙŠÙ†Ø§Øª Ø³ÙˆØ§Ø¡ Ø§Ø¶Ø§ÙØ© Ø§Ùˆ Ø®ØµÙ…
            let sumTotalSuppliesAddationAndSubtract = sumCurrentSuppliesValue.reduce( ( acc, val ) => acc + val, 0 );

            //Ø¬Ù„Ø¨ Ø§Ù„Ø§Ø¹Ù…Ø§Ù„ Ø§Ù„Ø³Ø§Ø¨Ù‚Ù‡
            let previousWorkValueSaved = Number( await dbNoUp_PandBill.keyGet( 'resultsTable', "PreviousWorksValue" ) );
            let previousWorkPercentValueSaved = Number( await dbNoUp_PandBill.keyGet( 'resultsTable', "PreviousWorksPercent" ) );
            //Ø¬Ù„Ø¨ Ø§Ù„ØªØ´ÙˆÙŠÙ†Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ù‡
            let previousSuppliesValueSaved = Number( await dbNoUp_PandBill.keyGet( 'resultsTable', "PreviousSuppliesValue" ) );
            let previousSuppliesPercentValueSaved = Number( await dbNoUp_PandBill.keyGet( 'resultsTable', "PreviousSuppliesPercent" ) );
            let previousSuppliesPriceSaved = Number( await dbNoUp_PandBill.keyGet( 'resultsTable', "PreviousSuppliesPrice" ) );

            //Ø·Ø±Ø­ Ø§Ù„Ø§Ø¹Ù…Ø§Ù„ Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© Ù…Ù† Ø§Ù„Ø­Ø§Ù„ÙŠØ©
            sumCurrentWorksValue.push( previousWorkValueSaved * -1 );
            sumCurrentWorksPercent.push( previousWorkPercentValueSaved );
            //Ø·Ø±Ø­ Ø§Ù„ØªØ´ÙˆÙŠÙ†Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© Ù…Ù† Ø§Ù„Ø­Ø§Ù„ÙŠØ©
            sumCurrentSuppliesValue.push( previousSuppliesValueSaved * -1 );
            sumCurrentSuppliesPercent.push( previousSuppliesPercentValueSaved );
            sumCurrentSuppliesPrices.push( previousSuppliesPriceSaved );
            //Ø­Ø³Ø§Ø¨ Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø§Ø¹Ù…Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ø¨Ø¹Ø¯ Ø·Ø±Ø­ Ø§Ù„Ø³Ø§Ø¨Ù‚ Ù…Ù†Ù‡Ø§
            const resultWorks = calculateTotalValuPercent( sumCurrentWorksValue, sumCurrentWorksPercent, sumTotalWorksAddationAndSubtract );
            worksOverPercent = resultWorks.totalValue * resultWorks.overallPercent;
            //Ø­Ø³Ø§Ø¨ Ø§Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø§Ø¹Ù…Ø§Ù„ Ø§Ù„Ø³Ø§Ø¨Ù‚ Ø¨Ø§Ù„Ø§Ø¶Ø§ÙØ© Ø§Ù„ÙŠ Ø§Ù„Ø­Ø§Ù„ÙŠ
            const totalResultWorks = calculateTotalValuPercent( [ resultWorks.totalValue, previousWorkValueSaved ], [ resultWorks.overallPercent, previousWorkPercentValueSaved ], sumTotalWorksAddationAndSubtract );
            //Ø­Ø³Ø§Ø¨ Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø§Ø¹Ù…Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ø¨Ø¹Ø¯ Ø·Ø±Ø­ Ø§Ù„Ø³Ø§Ø¨Ù‚ Ù…Ù†Ù‡Ø§
            const resultSuplies = calculateSuppliesPercentprice( sumCurrentSuppliesValue, sumCurrentSuppliesPercent, sumCurrentSuppliesPrices );
            suppliesOverPercent = resultSuplies.valueSum * resultSuplies.foundPercent;
            //Ø­Ø³Ø§Ø¨ Ø§Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø§Ø¹Ù…Ø§Ù„ Ø§Ù„Ø³Ø§Ø¨Ù‚ Ø¨Ø§Ù„Ø§Ø¶Ø§ÙØ© Ø§Ù„ÙŠ Ø§Ù„Ø­Ø§Ù„ÙŠ
            const totalResultSuplies = calculateSuppliesPercentprice( [ resultSuplies.valueSum, previousSuppliesValueSaved ], [ resultSuplies.foundPercent, previousSuppliesPercentValueSaved ], [ resultSuplies.foundPrice, previousSuppliesPriceSaved ] );

            //#endregion

            //#region  Ø¬Ù„Ø¨ Ø¹Ù†Ø§ØµØ± Ø§Ù„ØµÙØ­Ø© Ø§Ù„ØªÙŠ Ø³ÙŠØªÙ… ÙˆØ¶Ø¹ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ÙÙŠÙ‡Ø§
            //Ø¹Ù†Ø§ØµØ± Ù‚ÙŠÙ… Ø§Ù„Ø§Ø¹Ù…Ø§Ù„ 
            const TotalWorks = document.getElementById( 'TotalWorks' );
            const TotalWorksAddition = document.getElementById( 'TotalWorksAddition' );
            const TotalWorksDiscount = document.getElementById( 'TotalWorksDiscount' );
            //Ø¹Ù†Ø§ØµØ± Ù†Ø³Ø¨ Ø§Ù„Ø§Ø¹Ù…Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠØ© 
            const CurrentWorksValue = document.getElementById( 'CurrentWorksValue' );
            const CurrentWorksPercent = document.getElementById( 'CurrentWorksPercent' );
            const CurrentWorksTotalCost = document.getElementById( 'CurrentWorksTotalCost' );
            //Ø¹Ù†Ø§ØµØ± Ù†Ø³Ø¨ Ø§Ù„Ø§Ø¹Ù…Ø§Ù„ Ø§Ù„ÙƒÙ„ÙŠØ© 
            const TotalExecutedWorksValue = document.getElementById( 'TotalExecutedWorksValue' );
            const TotalExecutedWorksPercent = document.getElementById( 'TotalExecutedWorksPercent' );
            const TotalExecutedWorksTotalCost = document.getElementById( 'TotalExecutedWorksTotalCost' );
            //Ø¹Ù†Ø§ØµØ± Ù‚ÙŠÙ… Ø§Ù„ØªØ´ÙˆÙŠÙ†Ø§Øª 
            const TotalSupplies = document.getElementById( 'TotalSupplies' );
            const TotalSuppliesAddition = document.getElementById( 'TotalSuppliesAddition' );
            const TotalSuppliesDiscount = document.getElementById( 'TotalSuppliesDiscount' );
            //Ø¹Ù†Ø§ØµØ± Ù†Ø³Ø¨ Ø§Ù„ØªØ´ÙˆÙŠÙ†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ© 
            const CurrentSuppliesValue = document.getElementById( 'CurrentSuppliesValue' );
            const CurrentSuppliesPercent = document.getElementById( 'CurrentSuppliesPercent' );
            const CurrentSuppliesPrice = document.getElementById( 'CurrentSuppliesPrice' );
            const CurrentSuppliesTotalCost = document.getElementById( 'CurrentSuppliesTotalCost' );
            //Ø¹Ù†Ø§ØµØ± Ù†Ø³Ø¨ Ø§Ù„ØªØ´ÙˆÙŠÙ†Ø§Øª Ø§Ù„ÙƒÙ„ÙŠØ© 
            const TotalExecutedSuppliesValue = document.getElementById( 'TotalExecutedSuppliesValue' );
            const TotalExecutedSuppliesPercent = document.getElementById( 'TotalExecutedSuppliesPercent' );
            const TotalExecutedSuppliesPrice = document.getElementById( 'TotalExecutedSuppliesPrice' );
            const TotalExecutedSuppliesTotalCost = document.getElementById( 'TotalExecutedSuppliesTotalCost' );

            //#endregion

            //#region ÙˆØ¶Ø¹ Ø§Ù„Ù‚ÙŠÙ… ÙÙŠ Ø§Ù„Ø¹Ù†Ø§ØµØ±

            CurrentWorksValue.value = resultWorks.totalValue;
            CurrentWorksPercent.value = ( resultWorks.overallPercent );
            CurrentWorksTotalCost.value = ( ( resultWorks.overallPercent / 100 ) * resultWorks.totalValue * Number( pandPrice ) );
            //Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø§Ø¹Ù…Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠÙ‡ ÙˆØ§Ù„Ø³Ø§Ø¨Ù‚Ø©
            TotalExecutedWorksValue.value = totalResultWorks.totalValue;
            TotalExecutedWorksPercent.value = ( totalResultWorks.overallPercent );
            TotalExecutedWorksTotalCost.value = ( ( totalResultWorks.overallPercent / 100 ) * totalResultWorks.totalValue * Number( pandPrice ) );

            TotalWorks.value = sumTotalWorksAddationAndSubtract;
            TotalWorksAddition.value = sumTotalWorksAddition.reduce( ( acc, val ) => acc + val, 0 );
            TotalWorksDiscount.value = sumTotalWorksDiscount.reduce( ( acc, val ) => acc + val, 0 );

            TotalSupplies.value = sumTotalSuppliesAddationAndSubtract;
            TotalSuppliesAddition.value = sumTotalSuppliesAddition.reduce( ( acc, val ) => acc + val, 0 );
            TotalSuppliesDiscount.value = sumTotalSuppliesDiscount.reduce( ( acc, val ) => acc + val, 0 );

            CurrentSuppliesValue.value = Number( resultSuplies.valueSum );
            CurrentSuppliesPercent.value = Number( resultSuplies.foundPercent );
            CurrentSuppliesPrice.value = Number( resultSuplies.foundPrice );
            CurrentSuppliesTotalCost.value = ( ( Number( resultSuplies.foundPercent ) / 100 ) * Number( resultSuplies.valueSum ) * Number( resultSuplies.foundPrice ) );

            TotalExecutedSuppliesValue.value = ( totalResultSuplies.valueSum );
            TotalExecutedSuppliesPercent.value = ( totalResultSuplies.foundPercent );
            TotalExecutedSuppliesPrice.value = Number( totalResultSuplies.foundPrice );
            TotalExecutedSuppliesTotalCost.value = ( ( totalResultSuplies.foundPercent / 100 ) * totalResultSuplies.valueSum * Number( totalResultSuplies.foundPrice ) );

            //#endregion

            //#region Ø¥Ø·Ù„Ø§Ù‚ Ø­Ø¯Ø« Ø§Ù„ØªØºÙŠÙŠØ± ÙŠØ¯ÙˆÙŠÙ‹Ø§ Ù„ÙƒÙŠ ÙŠØªÙ… Ø§Ù„Ø­ÙØ¸
            const inputEvent = new Event( 'input', { bubbles: true } );
            //Ø§Ø­Ø¯Ø§Ø« Ù‚ÙŠÙ… Ø§Ù„Ø§Ø¹Ù…Ø§Ù„
            TotalWorks.dispatchEvent( inputEvent );
            TotalWorksAddition.dispatchEvent( inputEvent );
            TotalWorksDiscount.dispatchEvent( inputEvent );
            //Ø§Ø­Ø¯Ø§Ø« Ù†Ø³Ø¨ Ø§Ù„Ø§Ø¹Ù…Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠØ©
            CurrentWorksValue.dispatchEvent( inputEvent );
            CurrentWorksPercent.dispatchEvent( inputEvent );
            CurrentWorksTotalCost.dispatchEvent( inputEvent );
            //Ø§Ø­Ø¯Ø§Ø« Ù‚ÙŠÙ… Ø§Ù„ØªØ´ÙˆÙŠÙ†Ø§Øª
            TotalSupplies.dispatchEvent( inputEvent );
            TotalSuppliesAddition.dispatchEvent( inputEvent );
            TotalSuppliesDiscount.dispatchEvent( inputEvent );
            //Ø§Ø­Ø¯Ø§Ø« Ù†Ø³Ø¨ Ø§Ù„ØªØ´ÙˆÙŠÙ†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©
            CurrentSuppliesValue.dispatchEvent( inputEvent );
            CurrentSuppliesPercent.dispatchEvent( inputEvent );
            CurrentSuppliesPrice.dispatchEvent( inputEvent );
            CurrentSuppliesTotalCost.dispatchEvent( inputEvent );
            //Ø§Ø­Ø¯Ø§Ø« Ù†Ø³Ø¨ Ø§Ù„Ø§Ø¹Ù…Ø§Ù„ Ø§Ù„ÙƒÙ„ÙŠØ©
            TotalExecutedWorksValue.dispatchEvent( inputEvent );
            TotalExecutedWorksPercent.dispatchEvent( inputEvent );
            TotalExecutedWorksTotalCost.dispatchEvent( inputEvent );
            //Ø§Ø­Ø¯Ø§Ø« Ù†Ø³Ø¨ Ø§Ù„ØªØ´ÙˆÙŠÙ†Ø§Øª Ø§Ù„ÙƒÙ„ÙŠØ©
            TotalExecutedSuppliesValue.dispatchEvent( inputEvent );
            TotalExecutedSuppliesPercent.dispatchEvent( inputEvent );
            TotalExecutedSuppliesPrice.dispatchEvent( inputEvent );
            TotalExecutedSuppliesTotalCost.dispatchEvent( inputEvent );

            //#endregion

        } catch ( error )
        {
            // Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ø®Ø·Ø£ ÙÙŠ ÙˆØ­Ø¯Ø© Ø§Ù„ØªØ­ÙƒÙ…
            console.error( "Error calculating calSumBill0: ", error );
        } finally
        {
            isCalScalSumBill0Running = false;
        }
    }

    /**
  * Ø¯Ø§Ù„Ø© Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„ÙƒÙ„ÙŠØ© ÙˆØ§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„ÙƒÙ„ÙŠØ© Ù…Ù† Ù…ØµÙÙˆÙØªÙŠÙ†
  * @param {Array} values Ù…ØµÙÙˆÙØ© Ø§Ù„Ù‚ÙŠÙ…
  * @param {Array} percentages Ù…ØµÙÙˆÙØ© Ø§Ù„Ù†Ø³Ø¨ (0-100)
  * @param {number} referenceTotalValue (Ø§Ø®ØªÙŠØ§Ø±ÙŠ) Ù‚ÙŠÙ…Ø© Ù…Ø±Ø¬Ø¹ÙŠØ© Ù„Ø¥Ø¹Ø§Ø¯Ø© Ø§Ø­ØªØ³Ø§Ø¨ Ø§Ù„Ù†Ø³Ø¨Ø©
  * @returns {object} ÙƒØ§Ø¦Ù† ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„ÙƒÙ„ÙŠØ© ÙˆØ§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„ÙƒÙ„ÙŠØ©
  */
    function calculateTotalValuPercent ( values, percentages, referenceTotalValue = 0 )
    {
        try
        {
            let sumUsedValues = 0;
            let weightedSum = 0;

            for ( let i = 0; i < values.length; i++ )
            {
                const val = Number( values[ i ] );
                const pct = Number( percentages[ i ] ) / 100;

                if ( isNaN( val ) || isNaN( pct ) ) continue;

                sumUsedValues += val;
                weightedSum += val * pct;
            }

            let overallPercent = sumUsedValues !== 0
                ? ( weightedSum / sumUsedValues ) * 100
                : 0;

            if ( referenceTotalValue !== 0 )
            {
                const finalValue = sumUsedValues * ( overallPercent / 100 );
                overallPercent = ( finalValue / referenceTotalValue ) * 100;
                sumUsedValues = referenceTotalValue;
            }

            return {
                totalValue: Number( sumUsedValues ),
                overallPercent: Number( overallPercent )
            };
        } catch ( error )
        {
            console.log( 'âŒ Ø®Ø·Ø£ ÙÙŠ calculateTotalValueAndPercent:', error );
            return {
                totalValue: 0,
                overallPercent: 0
            };
        }
    }

    function calculateSuppliesPercentprice ( values, percents, prices )
    {
        if ( values.length !== percents.length || values.length !== prices.length )
        {
            throw new Error( "âŒ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ØµÙÙˆÙØ§Øª ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ø¨Ø·ÙˆÙ„ Ù…ØªØ³Ø§ÙˆÙ." );
        }
        const cleanValues = [];
        const cleanPercents = [];
        const cleanPrices = [];

        for ( let i = 0; i < values.length; i++ )
        {
            const value = values[ i ];
            const percent = percents[ i ];
            const price = prices[ i ];

            if ( isNumeric( value ) && isNumeric( percent ) && isNumeric( price ) )
            {
                cleanValues.push( value );
                cleanPercents.push( percent );
                cleanPrices.push( price );
            }
        }
        values = cleanValues;
        percents = cleanPercents;
        prices = cleanPrices;
        let totalSum = 0;
        let approvedValueSum = 0;
        let weightedPriceSum = 0;
        let approvedWeights = 0;

        for ( let i = 0; i < values.length; i++ )
        {
            const value = values[ i ];
            const percent = percents[ i ];
            const price = prices[ i ];

            const approvedValue = value * ( percent / 100 );
            totalSum += approvedValue * price;
            approvedValueSum += approvedValue;

            // Ù†Ø³ØªØ®Ø¯Ù… approvedValue Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† value Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù…Ø±Ø¬Ø­
            weightedPriceSum += price * approvedValue;
            approvedWeights += approvedValue;
        }

        if ( approvedValueSum === 0 )
        {
            console.log( "âš ï¸ Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ…ÙŠØ§Øª Ø§Ù„Ù…Ø¹ØªÙ…Ø¯Ø© (Ø¨Ø¹Ø¯ Ø¶Ø±Ø¨Ù‡Ø§ Ø¨Ø§Ù„Ù†Ø³Ø¨) ÙŠØ³Ø§ÙˆÙŠ ØµÙØ±ØŒ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª." );
        }

        const foundPrice = weightedPriceSum / approvedWeights;
        const foundPercent = 100; // Ù„Ø£Ù†Ù†Ø§ Ù†Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù…Ø±Ø¬Ø­ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ…ÙŠØ§Øª Ø§Ù„Ù…Ø¹ØªÙ…Ø¯Ø© Ù…Ø¨Ø§Ø´Ø±Ø©
        const checkTotal = foundPrice * approvedValueSum;

        return {
            totalSum: Number( totalSum ),
            valueSum: Number( approvedValueSum ),
            foundPercent: Number( foundPercent ),
            foundPrice: Number( foundPrice ),
            checkTotal: Number( checkTotal )
        };
    }

    /**
     * Ø¯Ø§Ù„Ø© Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© ÙˆØ¬Ù„Ø¨ Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ù…Ø®Ø²Ù†Ø© Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
     * ØªÙ‚ÙˆÙ… Ø¨ØªØ­Ø¯ÙŠØ« Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø­Ø³Ø¨ Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ù…Ø®Ø²Ù†Ø© Ø£Ùˆ ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
     */
    let stopInitialValues = false;
    async function initialValues ()
    {
        try
        {
            if ( stopInitialValues == true ) { return; }
            stopInitialValues = true;
            // ØªØ¹Ø·ÙŠÙ„ Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ù…Ø¤Ù‚ØªØ§Ù‹
            isTableWatcherEnabled = false;

            // ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
            const maxAttempts = 20;
            let allRows;
            let attempt = 0;

            // Ù…Ø­Ø§ÙˆÙ„Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ø¬Ø¯ÙˆÙ„ (Ø¨Ø­Ø¯ Ø£Ù‚ØµÙ‰ 20 Ù…Ø­Ø§ÙˆÙ„Ø©)
            while ( attempt < maxAttempts )
            {
                allRows = await dbNoUp_PandBill.getAllDataFromTable( "rows" );
                if ( Array.isArray( allRows ) ) break;
                await delay( 100 );
                attempt++;
            }

            if ( !Array.isArray( allRows ) )
            {
                isTableWatcherEnabled = true;
                return;
            }

            // Ù…Ø¹Ø§Ù„Ø¬Ø© ÙƒÙ„ ØµÙ Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            for ( const rawId of allRows )
            {
                try
                {
                    if ( !isValidIdFormat( rawId.key ) ) { continue; }


                    await waitForElement( `#${ rawId.key }_` );
                    let rawElement = document.getElementById( rawId.key + "_" );
                    if ( !rawElement ) { continue; }

                    const state = await dbNoUp_PandBill.keyGet( rawId.key, "PandBillStat" );
                    const percent = await dbNoUp_PandBill.keyGet( rawId.key, "PandBillPercent" );
                    const price = await dbNoUp_PandBill.keyGet( rawId.key, "PandBillPrice" );
                    const PandBillKindWork = await dbNoUp_PandBill.keyGet( rawId.key, "PandBillKindWork" );
                    const PandBillKindSum = await dbNoUp_PandBill.keyGet( rawId.key, "PandBillKindSum" );

                    //#region ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª ØºÙŠØ± Ù…Ø·Ø§Ø¨Ù‚Ø© Ù„Ù„Ù†Øµ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹
                    if ( state == null || state == "" )
                    {
                        await dbNoUp_PandBill.keySet( rawId.key, "PandBillStat", "0" );
                    }
                    //#endregion

                    // ØªØ¹ÙŠÙŠÙ† Ù†Ø³Ø¨Ø© Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©
                    if ( percent == null || percent === "" )
                    {
                        await dbNoUp_PandBill.keySet( rawId.key, "PandBillPercent", "100" );
                        let PercentElement = rawElement.querySelector( "#PandBillPercent" );
                        PercentElement.value = "100";
                    }

                    // ØªØ¹ÙŠÙŠÙ† Ø³Ø¹Ø± Ø§ÙØªØ±Ø§Ø¶ÙŠ Ø¥Ø°Ø§ ÙƒØ§Ù† ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯
                    if ( price == null || price === "" )
                    {
                        await dbNoUp_PandBill.keySet(
                            rawId.key,
                            "PandBillPrice",
                            pandPrice
                        );
                        let PriceElement = rawElement.querySelector( "#PandBillPrice" );
                        PriceElement.value = pandPrice;
                    }

                    //#region ØªØ¹ÙŠÙŠÙ† Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ Ø¥Ø°Ø§ ÙƒØ§Ù† ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯
                    if ( PandBillKindWork == null || PandBillKindWork === "" )
                    {
                        await dbNoUp_PandBill.keySet(
                            rawId.key,
                            "PandBillKindWork",
                            "0"
                        );
                        await isPriceEdit( rawId.key, 0 );
                        let KindWorkElement = rawElement.querySelector( "#PandBillKindWork" );
                        KindWorkElement.value = "0";
                    }
                    else
                    {
                        if ( PandBillKindWork == "0" )
                        {
                            await isPriceEdit( rawId.key, 0 );
                        } else
                        {
                            await isPriceEdit( rawId.key, 1 );
                        }
                    }
                    //#endregion

                    //#region ØªØ¹ÙŠÙŠÙ† Ù†ÙˆØ¹ Ø§Ù„ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ Ø¥Ø°Ø§ ÙƒØ§Ù† ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯
                    if ( PandBillKindSum == null || PandBillKindSum === "" )
                    {
                        await dbNoUp_PandBill.keySet(
                            rawId.key,
                            "PandBillKindSum",
                            "0"
                        );
                        let KindSumElement = rawElement.querySelector( "#PandBillKindSum" );
                        KindSumElement.value = "0";
                    }
                    //#endregion

                }
                catch ( error )
                {
                    continue;
                }
            }

            const priceWorks = document.querySelectorAll( '[id="priceWork"]' );
            priceWorks.forEach( ( priceWork ) =>
            {
                priceWork.innerText = pandPrice;
            } );

            // Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù‚ÙŠÙ… Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ Ø§Ù„ØµÙØ­Ø©
            await restoreAllInputsFromIndexDB( "results", dbNoUp_PandBill, 'resultsTable' );
            // Ù…Ø±Ø§Ù‚Ø¨Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ ÙˆØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù†Ø¯ Ø§Ù„ØªØºÙŠÙŠØ±
            await watchingAllInputs2IndexDB( "results", dbNoUp_PandBill, 'resultsTable' );

        } catch ( error )
        {
            // Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ø®Ø·Ø£ ÙÙŠ ÙˆØ­Ø¯Ø© Ø§Ù„ØªØ­ÙƒÙ…
            console.error( "ğŸš¨ Error in initialValues:", error );
        } finally
        {
            // Ø¥Ø¹Ø§Ø¯Ø© ØªÙØ¹ÙŠÙ„ Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø¬Ø¯ÙˆÙ„
            isTableWatcherEnabled = true;
            stopInitialValues = false;
        }
    }

    /**
     * Ø¯Ø§Ù„Ø© ØªÙ…ÙƒÙŠÙ† Ø£Ùˆ ØªØ¹Ø·ÙŠÙ„ Ø¥Ù…ÙƒØ§Ù†ÙŠØ© ØªØ¹Ø¯ÙŠÙ„ Ø­Ù‚Ù„ Ø§Ù„Ø³Ø¹Ø± ÙÙŠ ØµÙ Ø§Ù„Ø¬Ø¯ÙˆÙ„
     * @param {string} tableId Ù…Ø¹Ø±Ù Ø§Ù„ØµÙ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„
     * @param {number} state Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ù‚ÙŠÙ…Ø© 1 ÙŠØ¬Ø¹Ù„ Ø§Ù„Ø­Ù‚Ù„ Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªØ¹Ø¯ÙŠÙ„ØŒ ØºÙŠØ± Ø°Ù„Ùƒ ÙŠØ¬Ø¹Ù„Ù‡ Ù„Ù„Ù‚Ø±Ø§Ø¡Ø© ÙÙ‚Ø·
     */
    async function isPriceEdit ( tableId, state )
    {
        try
        {
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ù…Ø¹Ø±Ù Ø§Ù„ØµÙ
            if ( !isValidIdFormat( tableId ) ) { return; }

            // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¹Ù†ØµØ± Ø§Ù„ØµÙ Ù…Ù† Ø§Ù„ØµÙØ­Ø© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ø¹Ø±Ù
            let rawElement = document.getElementById( tableId + "_" );

            // Ø¥Ø°Ø§ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù†ØµØ±ØŒ Ø§Ù„Ø®Ø±ÙˆØ¬ Ù…Ù† Ø§Ù„Ø¯Ø§Ù„Ø©
            if ( !rawElement ) return;

            // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø¹Ù†ØµØ± Ø­Ù‚Ù„ Ø§Ù„Ø³Ø¹Ø± Ø¯Ø§Ø®Ù„ Ø§Ù„ØµÙ
            let priceElement = rawElement.querySelector( "#PandBillPrice" );

            // Ø¥Ø°Ø§ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø­Ù‚Ù„ Ø§Ù„Ø³Ø¹Ø±ØŒ Ø§Ù„Ø®Ø±ÙˆØ¬ Ù…Ù† Ø§Ù„Ø¯Ø§Ù„Ø©
            if ( !priceElement ) return;

            // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø­Ø§Ù„Ø© 1ØŒ Ø§Ø¬Ø¹Ù„ Ø§Ù„Ø­Ù‚Ù„ Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªØ¹Ø¯ÙŠÙ„
            if ( state === 1 )
            {
                priceElement.removeAttribute( "readonly" ); // Ø¥Ø²Ø§Ù„Ø© Ø®Ø§ØµÙŠØ© Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© ÙÙ‚Ø·
                priceElement.style.border = "1px solid #234890"; // Ø¥Ø¶Ø§ÙØ© Ø¥Ø·Ø§Ø± Ø£Ø²Ø±Ù‚
                priceElement.style.backgroundColor = "#234890"; // ØªØºÙŠÙŠØ± Ù„ÙˆÙ† Ø§Ù„Ø®Ù„ÙÙŠØ© Ù„Ù„Ø£Ø²Ø±Ù‚
                priceElement.style.color = "#fff"; // ØªØºÙŠÙŠØ± Ù„ÙˆÙ† Ø§Ù„Ø®Ø· Ù„Ù„Ø£Ø¨ÙŠØ¶ Ù„ÙŠØªÙ†Ø§Ø³Ø¨ Ù…Ø¹ Ø§Ù„Ø®Ù„ÙÙŠØ©
            } else
            {
                // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø­Ø§Ù„Ø© ØºÙŠØ± 1ØŒ Ø§Ø¬Ø¹Ù„ Ø§Ù„Ø­Ù‚Ù„ Ù„Ù„Ù‚Ø±Ø§Ø¡Ø© ÙÙ‚Ø·
                priceElement.setAttribute( "readonly", true ); // ØªÙØ¹ÙŠÙ„ Ø®Ø§ØµÙŠØ© Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© ÙÙ‚Ø·
                priceElement.style.border = "none"; // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¥Ø·Ø§Ø±
                priceElement.style.backgroundColor = "transparent"; // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø®Ù„ÙÙŠØ© Ù„Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ
                priceElement.style.color = ""; // Ø¥Ø¹Ø§Ø¯Ø© Ù„ÙˆÙ† Ø§Ù„Ø®Ø· Ù„Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ
            }
        } catch ( error )
        {
            // ÙÙŠ Ø­Ø§Ù„ Ø­Ø¯ÙˆØ« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªÙ†ÙÙŠØ°ØŒ Ø·Ø¨Ø§Ø¹ØªÙ‡ ÙÙŠ ÙˆØ­Ø¯Ø© Ø§Ù„ØªØ­ÙƒÙ…
            console.error( "Error in isPriceEdit:", error );
        }
    }

</script>